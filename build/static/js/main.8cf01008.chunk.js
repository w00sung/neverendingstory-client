(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{1018:function(e,t,a){},1019:function(e,t,a){},1020:function(e,t,a){},1022:function(e,t,a){},1023:function(e,t,a){},1024:function(e,t,a){},1025:function(e,t,a){},1026:function(e,t,a){},1027:function(e,t,a){},1028:function(e,t,a){},1033:function(e,t,a){},1034:function(e,t,a){},1035:function(e,t,a){},1036:function(e,t,a){},1037:function(e,t,a){},1038:function(e,t,a){},1039:function(e,t,a){},1040:function(e,t,a){},1041:function(e,t,a){},1042:function(e,t,a){},1043:function(e,t,a){},1045:function(e,t,a){},1051:function(e,t,a){},1052:function(e,t,a){},1086:function(e,t,a){},1090:function(e,t,a){"use strict";a.r(t);a(329),a(341),a(342),a(343),a(344),a(345),a(346),a(347),a(348),a(349),a(350),a(351),a(352),a(353),a(354),a(540),a(541),a(542),a(543),a(544),a(545),a(546),a(547),a(548),a(358),a(549),a(550),a(196),a(551),a(552),a(553),a(554),a(555),a(556),a(557),a(558),a(559),a(560),a(561),a(562),a(563),a(564),a(565),a(567),a(569),a(570),a(367),a(198),a(571),a(572),a(573),a(574),a(575),a(576),a(577),a(578),a(579),a(580),a(581),a(582),a(583),a(584),a(585),a(586),a(372),a(587),a(588),a(589),a(590),a(591),a(592),a(593),a(594),a(595),a(597),a(598),a(600),a(601),a(602),a(603),a(604),a(605),a(606),a(607),a(608),a(609),a(610),a(611),a(612),a(613),a(614),a(615),a(616),a(617),a(618),a(276),a(620),a(621),a(622),a(623),a(624),a(626),a(627),a(628),a(629),a(630),a(631),a(632),a(633),a(634),a(635),a(636),a(384),a(637),a(638),a(278),a(639),a(640),a(641),a(642),a(206),a(643),a(644),a(645),a(646),a(647),a(648),a(649),a(650),a(651),a(652),a(653),a(654),a(655),a(656),a(657),a(658),a(659),a(660),a(661),a(662),a(663),a(664),a(665),a(666),a(667),a(668),a(670),a(671),a(672),a(673),a(674),a(675),a(676),a(677),a(678),a(679),a(680),a(681),a(682),a(683),a(684),a(685),a(686),a(687),a(688),a(689),a(690),a(691),a(692),a(693),a(694),a(695),a(696),a(697),a(698),a(699),a(700),a(701),a(702),a(283),a(703),a(704),a(705),a(706),a(707),a(708),a(709),a(392),a(393),a(394),a(395),a(396),a(397),a(398),a(399),a(400),a(401),a(402),a(403),a(404),a(405),a(406),a(407),a(408),a(712),a(713),a(714),a(715),a(716),a(717),a(718),a(719),a(720),a(721),a(722),a(723),a(724),a(725),a(726),a(727),a(729),a(730),a(731),a(732),a(733),a(734),a(735),a(736),a(737),a(738),a(739),a(410),a(412),a(413),a(414),a(415),a(416),a(417),a(418),a(419),a(420),a(421),a(422),a(423),a(424),a(425),a(426),a(427),a(428),a(740),a(741),a(742),a(744),a(429),a(430),a(431),a(745),a(746),a(747),a(748),a(749),a(750),a(751),a(752),a(433),a(753),a(754),a(755),a(757),a(435),a(758),a(436);var n=a(0),c=a.n(n),r=a(8),l=a.n(r),i=(a(768),a(53)),s=a(9),o=a.n(s),u="15.164.48.192";function m(){return{type:"auth_user",payload:o.a.get("".concat("/api/users","/auth")).then((function(e){return e.data}))}}var d=a(15),p=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;function r(r){var l=Object(d.c)((function(e){return e.user})),i=Object(d.b)();return Object(n.useEffect)((function(){i(m()).then((function(e){e.payload.isAuth?(a&&!e.payload.isAdmin||!1===t)&&r.history.replace("/"):t&&r.history.push("/login")}))}),[]),c.a.createElement(e,Object.assign({},r,{user:l}))}return r},f=function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];function t(t){var a=Object(i.g)();return Object(n.useEffect)((function(){void 0===a.state&&t.history.replace("/")}),[]),a.state?c.a.createElement(e,t):c.a.createElement("div",null,"\uc798\ubabb\ub41c \uc811\uadfc\uc785\ub2c8\ub2e4\u314b\u314b")}return t},g=a(60),b=a.n(g),v=a(106),E=a(3),h=a(1110),y=(a(791),{arrow_1:"M-1.73589e-06 5.2875L16.6883 22.5L-2.31124e-07 39.7125L5.13765 45L27 22.5L5.13765 -2.24574e-07L-1.73589e-06 5.2875Z"});function _(e){var t=e.src,a=e.color,n=e.width,r=e.height;return c.a.createElement("svg",{width:n||"auto",height:r||"auto",viewBox:"0 0 27 45",fill:"none",xmlns:"http://www.w3.org/2000/svg"},c.a.createElement("path",{d:y[t],fill:a}))}function O(e){return c.a.createElement("svg",{width:"15",height:"3",viewBox:"0 0 15 3",fill:"none",xmlns:"http://www.w3.org/2000/svg"},c.a.createElement("rect",{width:"15",height:"3",fill:"white"}))}var j={id:"recent_gameList",pos:0,limit:3},k={id:"popular_gameList",pos:0,limit:2};function N(e){if(e.pos<e.limit-1){console.log(e.pos);var t=document.getElementById(e.id.split("_")[0]+"_bar"+String(e.pos));if(t.style.filter="brightness(50%)",e.pos+=1,document.getElementById(e.id).style.transform="translate(".concat(-1267*e.pos,"px, 0px)"),(t=document.getElementById(e.id.split("_")[0]+"_bar"+String(e.pos))).style.filter="brightness(100%)",e.pos==e.limit-1){var a=document.getElementById(e.id.split("_")[0]+"_right_arrow");a.style.display="none"}(a=document.getElementById(e.id.split("_")[0]+"_left_arrow")).style.display=""}}function S(e){if(e.pos>0){var t=document.getElementById(e.id.split("_")[0]+"_bar"+String(e.pos));if(t.style.filter="brightness(50%)",e.pos-=1,document.getElementById(e.id).style.transform="translate(".concat(-1267*e.pos,"px, 0px)"),(t=document.getElementById(e.id.split("_")[0]+"_bar"+String(e.pos))).style.filter="brightness(100%)",0==e.pos){var a=document.getElementById(e.id.split("_")[0]+"_left_arrow");a.style.display="none"}(a=document.getElementById(e.id.split("_")[0]+"_right_arrow")).style.display=""}}var x=function(e){var t=Object(n.useState)([]),a=Object(E.a)(t,2),r=a[0],l=a[1];Object(n.useEffect)((function(){o.a.get("/api/game/getgames").then((function(e){e.data.success?l(e.data.games):alert("game load\uc5d0 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4.")}))}),[]);var i=function(){var t=Object(v.a)(b.a.mark((function t(){var a,n,c;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,o.a.get("/api/game/uploadgameframe");case 2:if((a=t.sent).data.success){t.next=6;break}return alert("game Frame\uc81c\uc791 \uc2e4\ud328"),t.abrupt("return");case 6:return n={gameId:a.data.game._id,prevSceneId:null,sceneDepth:0,isFirst:1,title:""},t.next=9,o.a.post("/api/scene/create",n);case 9:if((c=t.sent).data.success){t.next=13;break}return alert("scene Frame\uc81c\uc791 \uc2e4\ud328"),t.abrupt("return");case 13:h.a.success("\uccab Scene\uc744 \uc0dd\uc131\ud574\uc8fc\uc138\uc694. \uc624\ub978\ucabd\uc758 \ubc84\ud2bc\uc744 \ud65c\uc6a9\ud574 \uc774\ubbf8\uc9c0\ub4e4\uc744 \ucd94\uac00\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4."),setTimeout((function(){e.history.replace({pathname:"/scene/make",state:{gameId:a.data.game._id,sceneId:c.data.sceneId}})}),1e3);case 15:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),s=0,u=r.map((function(e,t){return e.title?(s+=1,c.a.createElement("div",{key:t,className:"gamelist-game"},c.a.createElement("a",{href:"/game/".concat(e._id)},c.a.createElement("img",{className:"game-image",src:e.thumbnail,alt:e.title}),c.a.createElement("div",{className:"game-title"},e.title)),c.a.createElement("div",{className:"game-category"},e.category))):null}));return c.a.createElement("div",{className:"mainPage_container"},c.a.createElement("div",{className:"box-container"},c.a.createElement("button",{className:"button-newgame",onClick:i},"NEW \uac8c\uc784 \ub9cc\ub4e4\uae30")),c.a.createElement("div",{className:"box-container game-box"},c.a.createElement("div",{className:"box-title"},"\ucd5c\uadfc \ud50c\ub808\uc774\ud55c \uac8c\uc784"),c.a.createElement("div",{className:"box-positionBar"},c.a.createElement("div",{id:"recent_bar2",className:"bar"},c.a.createElement(O,null)),c.a.createElement("div",{id:"recent_bar1",className:"bar"},c.a.createElement(O,null)),c.a.createElement("div",{id:"recent_bar0",className:"bar",style:{filter:"brightness(100%)"}},c.a.createElement(O,null))),c.a.createElement("div",{className:"box-gameList"},c.a.createElement("div",{id:"recent_gameList",className:"gamelist-container",style:{width:335*s+"px"}},u),c.a.createElement("div",{id:"recent_left_arrow",className:"gamelist-left-arrow",style:{display:"none"},onClick:function(){S(j)}},c.a.createElement(_,{src:"arrow_1",width:"45",height:"27",color:"#F5F5F5"})),c.a.createElement("div",{id:"recent_right_arrow",className:"gamelist-right-arrow",onClick:function(){N(j)}},c.a.createElement(_,{src:"arrow_1",width:"45",height:"27",color:"#F5F5F5"})))),c.a.createElement("div",{className:"box-container game-box"},c.a.createElement("div",{className:"box-title"},"\uc778\uae30 \uac8c\uc784"),c.a.createElement("div",{className:"box-positionBar"},c.a.createElement("div",{id:"popular_bar1",className:"bar"},c.a.createElement(O,null)),c.a.createElement("div",{id:"popular_bar0",className:"bar",style:{filter:"brightness(100%)"}},c.a.createElement(O,null))),c.a.createElement("div",{className:"box-gameList"},c.a.createElement("div",{id:"popular_gameList",className:"gamelist-container",style:{width:335*s+"px"}},u),c.a.createElement("div",{id:"popular_left_arrow",className:"gamelist-left-arrow",style:{display:"none"},onClick:function(){S(k)}},c.a.createElement(_,{src:"arrow_1",width:"45",height:"27",color:"#F5F5F5"})),c.a.createElement("div",{id:"popular_right_arrow",className:"gamelist-right-arrow",onClick:function(){N(k)}},c.a.createElement(_,{src:"arrow_1",width:"45",height:"27",color:"#F5F5F5"})))))},w=a(1105),I=a(1103),C=a(151),L=a.n(C),B=a(71);a(831);var T=function(e,t){var a=Object(n.useRef)(t);Object(n.useEffect)((function(){a.current=t})),Object(n.useEffect)((function(){function t(t){t.code!==e||t.shiftKey||a.current(t)}return document.addEventListener("keypress",t),function(){return document.removeEventListener("keypress",t)}}),[e])};a(832),a(833);var D=function e(t){var a=t.gameId,r=t.comment,l=t.updateToggle_comment,i=Object(d.c)((function(e){return e.user})),s=Object(d.c)((function(e){return e.user.userData?e.user.userData.isAuth:null})),u=Object(d.c)((function(e){return e.user.userData?e.user.userData._id:null})),m=Object(n.useRef)(),p=Object(n.useState)(!0),f=Object(E.a)(p,2),g=f[0],b=f[1],v=Object(n.useState)(""),y=Object(E.a)(v,2),_=y[0],O=y[1],j=Object(n.useState)([]),k=Object(E.a)(j,2),N=k[0],S=k[1],x=Object(n.useState)(!1),w=Object(E.a)(x,2),I=w[0],C=w[1],L=function(){b((function(e){return!e}))},B={gameId:a,responseTo:r._id.toString()};Object(n.useEffect)((function(){o.a.post("/api/comment/getReply",B).then((function(e){e.data.success?S(e.data.result):h.a.error("\ub300\ub313\uae00\uc744 \ubd88\ub7ec\uc624\ub294\ub370 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4.")}))}),[g]);var T=N.map((function(t,n){return c.a.createElement("div",{key:n,style:{marginLeft:"10px"}},t&&c.a.createElement(e,{updateToggle_comment:L,gameId:a,comment:t}))}));return c.a.createElement("div",{className:"container_box"},c.a.createElement("div",{className:"comment_container"},c.a.createElement("img",{src:r.writer.image,alt:"img",className:"img"}),c.a.createElement("div",{className:"comment_contents"},c.a.createElement("div",{className:"nickname"},r.writer.nickname),c.a.createElement("div",{className:"content"},r.content),c.a.createElement("div",{className:"comment_info"},c.a.createElement("div",{className:"comment_like"},"\uc88b\uc544\uc694 : 0 "),c.a.createElement("div",{className:"comment_dislike"},"\uc2eb\uc5b4\uc694 : 0 "),N.length?c.a.createElement("div",{onClick:function(){"block"===m.current.style.display?m.current.style.display="none":m.current.style.display="block"},className:"comment_displayReplyToggle"},"\ub313\uae00 ",N.length,"\uac1c \ubcf4\uae30"):c.a.createElement("div",null),c.a.createElement("div",{onClick:function(){C((function(e){return!e}))},className:"comment_writeReplyToggle"},"\ub313\uae00 \uc791\uc131"),r.writer._id===u&&c.a.createElement("div",{onClick:function(){o.a.post("/api/comment/removeComment",{commentId:r._id}).then((function(e){e.data.success?(h.a.success("\ub313\uae00\uc774 \uc0ad\uc81c\ub418\uc5c8\uc2b5\ub2c8\ub2e4."),l()):h.a.error("\ub313\uae00 \uc0ad\uc81c\uc5d0 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4.")}))},className:"comment_delete"},"\ub313\uae00 \uc0ad\uc81c")),s&I?c.a.createElement("form",{className:"form"},c.a.createElement("textarea",{className:"textarea",onChange:function(e){O(e.currentTarget.value)},value:_,placeholder:"\ucf54\uba58\ud2b8\ub97c \uc791\uc131\ud574 \uc8fc\uc138\uc694."}),c.a.createElement("button",{className:"btn",onClick:function(e){if(e.preventDefault(),""!==_){var t={content:_,writer:i.userData._id,gameId:a,responseTo:r._id.toString()};o.a.post("/api/comment/saveComment",t).then((function(e){e.data.success?(h.a.success("\ub313\uae00 \uac10\uc0ac\ud569\ub2c8\ub2e4!"),L(),O(""),"block"!==m.current.style.display&&(m.current.style.display="block")):h.a.error("\ub313\uae00 \uc800\uc7a5\uc5d0 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4.")}))}}},"\ub313\uae00 \uc791\uc131")):c.a.createElement("div",null))),c.a.createElement("div",{ref:m,className:"reply_container"},T))};var M=function(e){var t=e.gameId,a=Object(d.c)((function(e){return e.user})),r=Object(d.c)((function(e){return e.user.userData?e.user.userData.isAuth:null})),l=Object(n.useState)(!0),i=Object(E.a)(l,2),s=i[0],u=i[1],m=Object(n.useState)(""),p=Object(E.a)(m,2),f=p[0],g=p[1],b=Object(n.useState)([]),v=Object(E.a)(b,2),y=v[0],_=v[1],O=function(){u((function(e){return!e}))};Object(n.useEffect)((function(){o.a.post("/api/comment/getComment",{gameId:t}).then((function(e){e.data.success?_(e.data.result):h.a.error("\ub313\uae00\uc744 \ubd88\ub7ec\uc624\ub294\ub370 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4.")}))}),[s]);var j=function(e){if(e.preventDefault(),""!==f){var n={content:f,writer:a.userData._id,gameId:t,responseTo:""};o.a.post("/api/comment/saveComment",n).then((function(e){e.data.success?(h.a.success("\ub313\uae00 \uac10\uc0ac\ud569\ub2c8\ub2e4!"),O(),g("")):h.a.error("\ub313\uae00 \uc800\uc7a5\uc5d0 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4.")}))}},k=y.map((function(e,a){return c.a.createElement("div",{key:a},e&&c.a.createElement(D,{updateToggle_comment:O,gameId:t,comment:e}))}));return c.a.createElement("div",{className:"container"},c.a.createElement("br",null),r&&c.a.createElement("form",{className:"form"},c.a.createElement("textarea",{className:"textarea",onChange:function(e){g(e.currentTarget.value)},value:f,placeholder:"\ucf54\uba58\ud2b8\ub97c \uc791\uc131\ud574 \uc8fc\uc138\uc694."}),c.a.createElement("button",{className:"btn",onClick:j},"\ub313\uae00 \uc791\uc131")),c.a.createElement("br",null),c.a.createElement("div",null,"\ub313\uae00 ",y.length,"\uac1c"),c.a.createElement("hr",null),k,c.a.createElement("br",null))};a(219);var F=function(e){var t=e.match.params.gameId,a={gameId:t},r=Object(n.useState)([]),l=Object(E.a)(r,2),i=l[0],s=l[1],u=Object(n.useState)([]),m=Object(E.a)(u,2),d=m[0],p=m[1],f=Object(n.useState)(!1),g=Object(E.a)(f,2),b=g[0],v=g[1];return Object(n.useEffect)((function(){o.a.post("/api/game/getgamedetail",a).then((function(e){e.data.success?s(e.data.gameDetail):h.a.error("\uac8c\uc784 \uc815\ubcf4\ub97c \ub85c\ub529\ud558\ub294\ub370 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4.")}))}),[]),Object(n.useEffect)((function(){o.a.get("/api/game/gamestart/".concat(t)).then((function(e){e.data.success?(p(e.data.sceneId),v(e.data.isMaking)):h.a.error("\ub85c\uadf8\uc778 \ud574\uc8fc\uc138\uc694.")}))}),[]),c.a.createElement("div",{className:"detailPage__container"},i.thumbnail&&c.a.createElement("img",{style:{width:"30%",height:"30%"},src:i.thumbnail,alt:"thumbnail"}),c.a.createElement("div",null,"\uc81c\ubaa9: ",i.title),c.a.createElement("div",null,"\uce74\ud14c\uace0\ub9ac : ",i.category),c.a.createElement("div",null,"\ud06c\ub9ac\uc5d0\uc774\ud130: ",i.creator),c.a.createElement("div",null,i.description),c.a.createElement("br",null),c.a.createElement(B.b,{style:{color:"#f05454"},to:{pathname:b?"/scene/make":"/gameplay",state:{gameId:t,sceneId:d}}},"\uac8c\uc784 \uc2dc\uc791\ud558\uae30"),c.a.createElement(M,{gameId:t}))};w.a.Title,I.a.Meta;var R=a(252),P=a(81),z=a(1104),U=a(1111),A=a(19),H=a(1108),G=a(120),q=w.a.Title;var W=Object(i.h)((function(e){var t=Object(d.b)(),a=!!localStorage.getItem("rememberMe"),r=Object(n.useState)(""),l=Object(E.a)(r,2),i=l[0],s=l[1],u=Object(n.useState)(a),m=Object(E.a)(u,2),p=m[0],f=m[1],g=function(){f(!p)},b=localStorage.getItem("rememberMe")?localStorage.getItem("rememberMe"):"";return c.a.createElement(R.a,{initialValues:{email:b,password:""},validationSchema:P.object().shape({email:P.string().email("Email is invalid").required("Email is required"),password:P.string().min(6,"Password must be at least 6 characters").required("Password is required")}),onSubmit:function(a,n){var c=n.setSubmitting;setTimeout((function(){var n={email:a.email,password:a.password};t(function(e){return{type:"login_user",payload:o.a.post("".concat("/api/users","/login"),e).then((function(e){return e.data}))}}(n)).then((function(t){t.payload.loginSuccess?(window.localStorage.setItem("userId",t.payload.userId),!0===p?window.localStorage.setItem("rememberMe",a.id):localStorage.removeItem("rememberMe"),e.history.replace("/")):s("Check out your Account or Password again")})).catch((function(e){s("Check out your Account or Password again"),setTimeout((function(){s("")}),3e3)})),c(!1)}),500)}},(function(e){var t=e.values,a=e.touched,n=e.errors,r=e.isSubmitting,l=e.handleChange,s=e.handleBlur,o=e.handleSubmit;return c.a.createElement("div",{className:"app"},c.a.createElement(q,{level:2},"Log In"),c.a.createElement("form",{onSubmit:o,style:{width:"350px"}},c.a.createElement(z.a.Item,{required:!0},c.a.createElement(U.a,{id:"email",prefix:c.a.createElement(A.a,{type:"user",style:{color:"rgba(0,0,0,.25)"}}),placeholder:"Enter your email",type:"email",value:t.email,onChange:l,onBlur:s,className:n.email&&a.email?"text-input error":"text-input"}),n.email&&a.email&&c.a.createElement("div",{className:"input-feedback"},n.email)),c.a.createElement(z.a.Item,{required:!0},c.a.createElement(U.a,{id:"password",prefix:c.a.createElement(A.a,{type:"lock",style:{color:"rgba(0,0,0,.25)"}}),placeholder:"Enter your password",type:"password",value:t.password,onChange:l,onBlur:s,className:n.password&&a.password?"text-input error":"text-input"}),n.password&&a.password&&c.a.createElement("div",{className:"input-feedback"},n.password)),i&&c.a.createElement("label",null,c.a.createElement("p",{style:{color:"#ff0000bf",fontSize:"0.7rem",border:"1px solid",padding:"1rem",borderRadius:"10px"}},i)),c.a.createElement(z.a.Item,null,c.a.createElement(H.a,{id:"rememberMe",onChange:g,checked:p},"Remember me"),c.a.createElement("a",{className:"login-form-forgot",href:"/reset_user",style:{float:"right"}},"forgot password"),c.a.createElement("div",null,c.a.createElement(G.a,{type:"primary",htmlType:"submit",className:"login-form-button",style:{minWidth:"100%"},disabled:r,onSubmit:o},"Log in")),"Or ",c.a.createElement("a",{href:"/register"},"register now!"))))}))})),X={labelCol:{xs:{span:24},sm:{span:8}},wrapperCol:{xs:{span:24},sm:{span:16}}},Q={wrapperCol:{xs:{span:24,offset:0},sm:{span:16,offset:8}}};var Y=function(e){var t=Object(d.b)();return c.a.createElement(R.a,{initialValues:{email:"",nickname:"",password:"",confirmPassword:""},validationSchema:P.object().shape({nickname:P.string().required("Name is required"),email:P.string().email("Email is invalid").required("Email is required"),password:P.string().min(6,"Password must be at least 6 characters").required("Password is required"),confirmPassword:P.string().oneOf([P.ref("password"),null],"Passwords must match").required("Confirm Password is required")}),onSubmit:function(a,n){var c=n.setSubmitting;setTimeout((function(){var n={email:a.email,password:a.password,nickname:a.nickname,image:"http://gravatar.com/avatar/".concat(L()().unix(),"?d=identicon")};t(function(e){return{type:"register_user",payload:o.a.post("".concat("/api/users","/register"),e).then((function(e){return e.data}))}}(n)).then((function(t){t.payload.success?e.history.push("/login"):alert(t.payload.err.errmsg)})),c(!1)}),500)}},(function(e){var t=e.values,a=e.touched,n=e.errors,r=e.isSubmitting,l=e.handleChange,i=e.handleBlur,s=e.handleSubmit;return c.a.createElement("div",{className:"app"},c.a.createElement("h2",null,"Sign up"),c.a.createElement(z.a,Object.assign({style:{minWidth:"375px"}},X,{onSubmit:s}),c.a.createElement(z.a.Item,{required:!0,label:"Name"},c.a.createElement(U.a,{id:"nickname",placeholder:"Enter your name",type:"text",value:t.nickname,onChange:l,onBlur:i,className:n.nickname&&a.nickname?"text-input error":"text-input"}),n.nickname&&a.nickname&&c.a.createElement("div",{className:"input-feedback"},n.nickname)),c.a.createElement(z.a.Item,{required:!0,label:"Email",hasFeedback:!0,validateStatus:n.email&&a.email?"error":"success"},c.a.createElement(U.a,{id:"email",placeholder:"Enter your Email",type:"email",value:t.email,onChange:l,onBlur:i,className:n.email&&a.email?"text-input error":"text-input"}),n.email&&a.email&&c.a.createElement("div",{className:"input-feedback"},n.email)),c.a.createElement(z.a.Item,{required:!0,label:"Password",hasFeedback:!0,validateStatus:n.password&&a.password?"error":"success"},c.a.createElement(U.a,{id:"password",placeholder:"Enter your password",type:"password",value:t.password,onChange:l,onBlur:i,className:n.password&&a.password?"text-input error":"text-input"}),n.password&&a.password&&c.a.createElement("div",{className:"input-feedback"},n.password)),c.a.createElement(z.a.Item,{required:!0,label:"Confirm",hasFeedback:!0},c.a.createElement(U.a,{id:"confirmPassword",placeholder:"Enter your confirmPassword",type:"password",value:t.confirmPassword,onChange:l,onBlur:i,className:n.confirmPassword&&a.confirmPassword?"text-input error":"text-input"}),n.confirmPassword&&a.confirmPassword&&c.a.createElement("div",{className:"input-feedback"},n.confirmPassword)),c.a.createElement(z.a.Item,Q,c.a.createElement(G.a,{onClick:s,type:"primary",disabled:r},"Submit"))))}))};a(1018);var V=function(){var e=Object(d.c)((function(e){return e.user.userData}));if(e){return c.a.createElement("div",null,c.a.createElement("img",{src:e.image,alt:""}),c.a.createElement("div",null,e.email),c.a.createElement("div",null,e.nickname),function(e){return e.makingGameList.map((function(e,t){return c.a.createElement(c.a.Fragment,null,c.a.createElement("div",null,e.gameId),c.a.createElement(B.b,{to:{pathname:"/scene/make}",state:{gameId:e.gameId,sceneId:e.sceneId}},key:t},"\uac8c\uc784 \ub9cc\ub4e4\ub7ec\uac00\uae30.."))}))}(e))}return c.a.createElement("div",null,"loading...")},K=a(110),J=(a(1019),U.a.TextArea),Z=w.a.Title,$=[{value:0,label:"Private"},{value:1,label:"Public"}],ee=[{value:0,label:"\uc0b4\uc544\ub0a8\uae30"},{value:1,label:"\ub85c\ub9e8\uc2a4"},{value:2,label:"\uc2a4\ud1a0\ub9ac"},{value:3,label:"\ucd94\ub9ac"},{value:4,label:"\ubcd1\ub9db"}];"".concat(9/16),"".concat(16/9);var te=function(e){var t=Object(d.c)((function(e){return e.user})),a=Object(n.useState)(""),r=Object(E.a)(a,2),l=r[0],i=r[1],s=Object(n.useState)(""),m=Object(E.a)(s,2),p=m[0],f=m[1],g=Object(n.useState)(0),b=Object(E.a)(g,2),v=b[0],y=b[1],_=Object(n.useState)("\uc0b4\uc544\ub0a8\uae30"),O=Object(E.a)(_,2),j=O[0],k=O[1],N=Object(n.useState)(!0),S=Object(E.a)(N,2),x=S[0],w=S[1],I=Object(n.useState)(""),C=Object(E.a)(I,2),L=C[0],B=C[1],T=function(e){w((function(e){return!e}))},D=function(a){if(a.preventDefault(),""!==l&&""!==p&&""!==L){var n;n=x?9/16:16/9;var c={creator:t.userData._id,title:l,description:p,thumbnail:L,privacy:v,category:j,ratio:n,writer:[t.userData._id],character:[],background:[],bgm:[],sound:[]};o.a.post("/api/game/uploadgame",c).then((function(t){t.data.success?(h.a.success("\uccab Scene\uc744 \uc0dd\uc131\ud574\uc8fc\uc138\uc694. \uc624\ub978\ucabd\uc758 +\ubc84\ud2bc\uc744 \ud65c\uc6a9\ud574 \uc774\ubbf8\uc9c0\ub4e4\uc744 \ucd94\uac00\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4."),setTimeout((function(){e.history.replace("/game/upload/".concat(t.data.game._id))}),1e3)):alert("game\uc81c\uc791 \uc2e4\ud328")}))}else alert("\ubaa8\ub4e0 \uc815\ubcf4\ub97c \uc785\ub825\ud574\uc8fc\uc138\uc694.")};return c.a.createElement("div",{style:{maxWidth:"700px",margin:"2rem auto"}},c.a.createElement("div",{style:{textAlign:"center",marginBottom:"2rem"}},c.a.createElement(Z,{level:2},"Upload Game")),c.a.createElement(z.a,{onSubmit:D},c.a.createElement("div",{style:{display:"flex",justifyContent:"space-between"}},c.a.createElement(K.a,{onDrop:function(e){if(e[0]){var t=new FormData;t.append("file",e[0]),o.a.post("/api/game/uploadfiles",t,{header:{"content-type":"multipart/form-data"}}).then((function(e){e.data.success?B(e.data.url):alert("\uc5c5\ub85c\ub4dc \uc2e4\ud328")}))}else alert("\uc190\uc0c1\ub41c \ud30c\uc77c\uc785\ub2c8\ub2e4.")},multiple:!1,maxSize:1e9},(function(e){var t=e.getRootProps,a=e.getInputProps;return c.a.createElement("div",Object.assign({style:{width:"300px",height:"240px",border:"1px solid lightgray",display:"flex",alignItems:"center",justifyContent:"center"}},t()),c.a.createElement("input",a()),c.a.createElement(A.a,{type:"plus",style:{fontSize:"3rem"}}))})),L&&c.a.createElement("div",null,c.a.createElement("img",{className:"thumbnail__img",src:"http://".concat(u,":5000/").concat(L),alt:"thumbnail"}))),c.a.createElement("br",null),c.a.createElement("br",null),c.a.createElement("label",null,"Title"),c.a.createElement(U.a,{onChange:function(e){i(e.currentTarget.value)},value:l}),c.a.createElement("br",null),c.a.createElement("br",null),c.a.createElement("label",null,"Description"),c.a.createElement(J,{onChange:function(e){f(e.currentTarget.value)},value:p}),c.a.createElement("br",null),c.a.createElement("br",null),c.a.createElement("select",{onChange:function(e){y(e.currentTarget.value)}},$.map((function(e,t){return c.a.createElement("option",{key:t,value:e.value},e.label)}))),c.a.createElement("br",null),c.a.createElement("br",null),c.a.createElement("select",{onChange:function(e){var t=e.currentTarget.value;k(e.currentTarget[t].text)}},ee.map((function(e,t){return c.a.createElement("option",{key:t,value:e.value},e.label)}))),c.a.createElement("br",null),c.a.createElement("br",null),c.a.createElement("label",null,c.a.createElement("input",{type:"radio",name:"ratio",checked:x,onChange:T}),"\ucef4\ud4e8\ud130"),c.a.createElement("br",null),c.a.createElement("label",null,c.a.createElement("input",{type:"radio",name:"ratio",checked:!x,onChange:T}),"\uc2a4\ub9c8\ud2b8\ud3f0"),c.a.createElement("br",null),c.a.createElement("br",null),c.a.createElement(G.a,{type:"primary",size:"large",onClick:D},"Next Step")))};a(82),a(153),w.a.Title,a(219);var ae=a(27),ne=a(17),ce=(a(1020),a(1021),a(1022),a(1023),function(e){var t=e.characterList.map((function(e,t){return c.a.createElement("div",{key:t},c.a.createElement("div",{className:"CharacterBlock",style:{left:"".concat(e.posX,"%")}},c.a.createElement("div",{className:"character__container",style:{height:"".concat(e.size,"%"),top:"".concat(e.posY,"%")}},c.a.createElement("img",{className:"characterImg",src:e.image,alt:"img"}))))}));return c.a.createElement("div",{className:"CharacterBlocks"},t)}),re=(a(1024),a(1107)),le=z.a.create({name:"modal_form"})((function(e){var t=e.visible,a=e.onCancel,n=e.onCreate,r=e.form,l=e.remainTime,i=r.getFieldDecorator;return T("Enter",(function(){n()})),t?c.a.createElement(re.a,{visible:!0,title:"\uc120\ud0dd\uc9c0 \ub0b4\uc6a9\uc744 \uc785\ub825\ud558\uc138\uc694 (".concat(l,")"),okText:"Submit",onCancel:a,onOk:n},c.a.createElement(z.a,{layout:"vertical"},c.a.createElement(z.a.Item,{label:"Title"},i("title",{rules:[{required:!0,message:"Please input the title of collection!"}]})(c.a.createElement(U.a,{ref:function(e){return e&&e.focus()}}))))):""}));function ie(e){return{type:"gameLoading_gamePlay",payload:e}}function se(e){return{type:"pause_gamePlay",payload:e}}var oe=function(e){var t,a=e.scene_id,r=e.scene_depth,l=e.game_id,s=e.scene_next_list,u=Object(d.b)(),m=Object(i.f)(),p=Object(d.c)((function(e){return e.user})),f=Object(d.c)((function(e){return e.sync.emptyNum})),g=p.userData._id.toString(),h=Object(n.useState)(!1),y=Object(E.a)(h,2),_=y[0],O=y[1],j=Object(n.useState)(null),k=Object(E.a)(j,2),N=k[0],S=k[1],x=Object(n.useState)(0),w=Object(E.a)(x,2),I=w[0],C=w[1],L=Object(n.useState)(null),B=Object(E.a)(L,2),T=B[0],D=B[1],M=Object(n.useState)(1),F=Object(E.a)(M,2),R=F[0],P=F[1],z=Object(n.useCallback)((function(e){null!==e&&S(e)}),[]),U=function(){At.emit("empty_num_increase",{scene_id:a,user_id:g}),clearTimeout(T),console.log("deleted -- ",T),O(!1),u(se(!1))},A=Object(n.useState)(0),H=Object(E.a)(A,2),G=H[0],q=H[1];Object(n.useEffect)((function(){At.off("validated"),At.on("validated",(function(e){P(-1*R)})),At.off("decrease_failed"),At.on("decrease_failed",(function(){O(!1),q(0),q(1)})),At.emit("validate_empty_num",{scene_id:a})}),[a]),Object(n.useEffect)((function(){G&&(clearTimeout(T),console.log("failed.. deleted -- ",T),console.log("visible false"))}),[G]);var W=Object(n.useState)(),X=Object(E.a)(W,2),Q=X[0],Y=X[1];return Object(n.useEffect)((function(){var e=(Array.isArray(s)?s.length:0)+f;e>=0&&e<=4&&(console.log("working Cnt : ",e),Y(Object(ne.a)(Array(4-e)).map((function(e,t){return c.a.createElement("div",{key:t},"\uc791\uc5c5\uc911..",c.a.createElement("br",null))}))))}),[f,s]),c.a.createElement(c.a.Fragment,null,Q,f>0&&c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{id:"choice",onClick:function(){u(se(!0)),clearTimeout(T),console.log("deleted -- ",T);var e=30;C(e),t=setInterval((function(){if(console.log("timer is not deleted~~~~~~~~~~~"),0===--e)return console.log("tick\uc774 0\uc774\ub77c\uc11c \uc2e4\ud589\ud569\ub2c8\ub2e4."),clearInterval(t),void U();C(e)}),970),console.log("made -- ",t),D(t),At.emit("empty_num_decrease",{scene_id:a,user_id:g}),O(!0)},style:{color:"red"}},"\uc120\ud0dd\uc758 \uae38...")),c.a.createElement(le,{ref:z,visible:_,onCancel:U,onCreate:function(){N.validateFields(function(){var e=Object(v.a)(b.a.mark((function e(t,n){var c,i;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(clearTimeout(T),console.log("deleted -- ",T),!t&&_){e.next=4;break}return e.abrupt("return");case 4:return c={gameId:l,prevSceneId:a,isFirst:0,sceneDepth:r+1,title:n.title},e.next=7,o.a.post("/api/scene/create",c);case 7:i=e.sent,At.emit("created_choice",{sceneId:a,userId:g,exp:i.data.exp}),N.resetFields(),O(!1),m.replace({pathname:"/scene/make",state:{gameId:l,sceneId:i.data.sceneId}});case 12:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}())},remainTime:I}))},ue=a(535);var me=function(e,t){var a=Object(n.useRef)(t);Object(n.useEffect)((function(){a.current=t})),Object(n.useEffect)((function(){function t(e){a.current(e)}return document.addEventListener(e,t),function(){return document.removeEventListener(e,t)}}),[])};var de=function(e){var t=e.cut_script,a=e.setIsTyping,r=Object(n.useState)(!1),l=Object(E.a)(r,2),i=l[0],s=l[1],o=Object(ue.a)(t,{pace:function(){return 150},onFinished:function(){s(!0)}}),u=Object(E.a)(o,2),m=u[0],d=u[1].skip;function p(e){d()}return T("Enter",p),T("Space",p),me("mouseup",p),Object(n.useEffect)((function(){return function(){a(!1)}}),[i]),t?c.a.createElement("div",null,m):c.a.createElement("div",null)},pe=function(e){var t=e.cut_name,a=e.cut_script,n=e.setIsTyping,r=e.isTyping;return c.a.createElement("div",{className:"text_container"},c.a.createElement("div",{className:"name_block"},t),c.a.createElement("hr",{className:"text_line"}),c.a.createElement("br",null),c.a.createElement("div",{className:"text_block"},c.a.createElement("div",null,r?c.a.createElement(de,{cut_script:a,setIsTyping:n}):a)))},fe=function(e){var t=e.game_id,a=e.cut_name,n=e.cut_script,r=e.scene_next_list,l=e.scene_id,i=e.scene_depth,s=e.setIsTyping,o=e.isTyping,u=r.map((function(e,a){return c.a.createElement(B.b,{to:{pathname:"/gameplay",key:a,state:{gameId:t,sceneId:e.sceneId}},key:a},e.script," ",c.a.createElement("br",null))}));return c.a.createElement("div",{className:"text_container"},c.a.createElement("div",{className:"name_block"},a),c.a.createElement("hr",{className:"text_line"}),c.a.createElement("div",{className:"text_block"},o?c.a.createElement(de,{cut_script:n,setIsTyping:s}):n,c.a.createElement("br",null),c.a.createElement("div",null,u),c.a.createElement("br",null),r.length<4?c.a.createElement("div",null,c.a.createElement(oe,{scene_id:l,scene_depth:i,game_id:t,scene_next_list:r})):c.a.createElement("div",null)))};a(1025);var ge=function(e){var t=e.gameId,a=e.sceneId,r=e.trigger,l=e.setTrigger,i=Object(d.c)((function(e){return e.user})),s=Object(n.useState)(""),u=Object(E.a)(s,2),m=u[0],p=u[1],f=Object(n.useState)(""),g=Object(E.a)(f,2),b=g[0],v=g[1];return r?c.a.createElement("div",{className:"dislike_popup"},c.a.createElement("div",{className:"dislike_inner"},c.a.createElement("button",{className:"close_btn",onClick:function(){return l((function(e){return!e}))}},"close"),c.a.createElement("label",null,"Title"),c.a.createElement("input",{onChange:function(e){p(e.currentTarget.value)},value:m}),c.a.createElement("label",null,"Description"),c.a.createElement("textarea",{onChange:function(e){v(e.currentTarget.value)},value:b}),c.a.createElement("button",{className:"btn",onClick:function(e){e.preventDefault();var n={title:m,description:b,user:i.userData._id,sceneId:a,gameId:t};o.a.post("/api/complaint/save",n).then((function(e){e.data.success?(h.a.success("\uac10\uc0ac\ud569\ub2c8\ub2e4. \uc2e0\uace0\uac00 \uc811\uc218\ub418\uc5c8\uc2b5\ub2c8\ub2e4."),l((function(e){return!e}))):h.a.error("\uc2e0\uace0\ud558\ub294\ub370 \ubb38\uc81c\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4.")}))}},"\uc2e0\uace0\ud558\uae30"))):""};a(1026);function be(){var e=document.getElementsByClassName("HistoryMap_inner")[0],t=window.getComputedStyle(e).getPropertyValue("transform"),a="none"!==t?parseInt(t.split(",")[4]):0;e.style.transform="translate(".concat(a+250,"px, 0px)")}function ve(){var e=document.getElementsByClassName("HistoryMap_inner")[0],t=window.getComputedStyle(e).getPropertyValue("transform"),a="none"!==t?parseInt(t.split(",")[4]):0;e.style.transform="translate(".concat(a-250,"px, 0px)")}var Ee=function(e){var t=e.userhistory,a=e.setTrigger,r=e.history,l=r.gameId,i=r.sceneId,s=Object(n.useState)(null),u=Object(E.a)(s,2),m=u[0],d=u[1],p=Object(n.useState)(null),f=Object(E.a)(p,2),g=f[0],b=f[1],v=Object(n.useState)(null),y=Object(E.a)(v,2),_=y[0],O=y[1];function j(e,t,a){b(setTimeout((function(){!function(e){var t=e.index,a=e.scene,n=e.setSceneInfo;o.a.get("/api/game/getSceneInfo/".concat(a)).then((function(e){if(e.data.success){var a=e.data.scene.cutList,c=a[a.length-1];n({sceneindex:t,background:null===c||void 0===c?void 0:c.background,name:null===c||void 0===c?void 0:c.name,script:null===c||void 0===c?void 0:c.script})}else alert("Scene \uc815\ubcf4 \uc5c6\uc74c...")}))}({index:e,scene:t,setSceneInfo:a})}),300))}var k=i.map((function(e,t){return c.a.createElement("div",{className:"HistoryMap_scene",key:t+1,onMouseEnter:function(){return j(t,e,O)},onMouseLeave:function(){return O(null),void clearTimeout(g)},onClick:function(){return d(t+1)}},_&&_.sceneindex===t?c.a.createElement("div",null,c.a.createElement("div",{className:"HistoryMap_scene_num"}," #",t+1),c.a.createElement("img",{className:"HistoryMap_scene_img",src:_.background}),c.a.createElement("div",{className:"HistoryMap_scene_name"},_.name,":"),c.a.createElement("div",{className:"HistoryMap_scene_text"},'"',_.script,'"')):c.a.createElement("div",null,c.a.createElement("div",{className:"HistoryMap_scene_num"}," #",t+1)))}));return e.trigger?c.a.createElement("div",{className:"HistoryMap_popup"},c.a.createElement("button",{className:"close_btn",onClick:function(){a(!1)}},"close"),c.a.createElement("div",{className:"toleft_btn",onClick:be},"to left \ub098\uc911\uc5d0 \uc774\ubbf8\uc9c0\ub85c \ub300\uccb4"),c.a.createElement("div",{className:"toright_btn",onClick:ve},"to right \ub098\uc911\uc5d0 \uc774\ubbf8\uc9c0\ub85c \ub300\uccb4"),c.a.createElement("div",{className:"HistoryMap_inner"},k),m?c.a.createElement("div",{className:"warning_popup"},c.a.createElement("button",{className:"ok_btn",onClick:function(){return function(e){var t=e.userhistory,a=e.gameId,n=e.sceneId,c=e.GoScene,r={data:{sceneIndex:c-1}};o.a.post("/api/game/refreshHistory",r).then((function(e){if(e.data.success){t.replace({pathname:"/gameplay",state:{sceneId:n[c-1],gameId:a}});for(var r=document.getElementsByClassName("close_btn"),l=r.length-1;l>=0;l--)r[l].click()}else h.a.error("Scene \ubcc0\uacbd \uc694\uccad \uc2e4\ud328")}))}({userhistory:t,gameId:l,sceneId:i,GoScene:m})}},"ok"),c.a.createElement("button",{className:"close_btn",onClick:function(){return d(null)}},"close"),c.a.createElement("div",{className:"warning_text"},"are you sure? \ub2e4\uc2dc\ub294 \ub3cc\uc544\uc62c \uc218 \uc5c6\ub2e4?")):null):null},he=(a(1027),0),ye=1,_e=2,Oe=3,je=4,ke=5,Ne=function(){switch(Object(d.c)((function(e){return e.gameplay.loadingType}))){case he:return null;case ye:return c.a.createElement("div",{style:{animation:"1.5s ease-out 0s 1 basic"},className:"loading_page"},c.a.createElement("div",{className:"loading_icon"},"loading....."));case _e:return c.a.createElement("div",{style:{animation:"1s ease-out 0s 1 slideLeft"},className:"loading_page"});case Oe:return c.a.createElement("div",{style:{animation:"1s ease-out 0s 1 slideRight"},className:"loading_page"});case je:return c.a.createElement("div",{style:{animation:"1s ease-out 0s 1 slideUp"},className:"loading_page"});case ke:return c.a.createElement("div",{style:{animation:"1s ease-out 0s 1 slideDown"},className:"loading_page"});default:return null}};function Se(e){return console.log(e),{type:"load_empty_num",payload:void 0!==e.emptyNum?e.emptyNum:o.a.get("/api/game/getSceneInfo/".concat(e.sceneId)).then((function(e){return console.log(e.data),e.data.scene.sceneTmp.emptyNum}))}}function xe(e){return{type:"navbar_control",payload:e}}function we(){if("undefined"!==typeof document.fullscreenElement)return"fullscreenElement";if("undefined"!==typeof document.mozFullScreenElement)return"mozFullScreenElement";if("undefined"!==typeof document.msFullscreenElement)return"msFullscreenElement";if("undefined"!==typeof document.webkitFullscreenElement)return"webkitFullscreenElement";throw new Error("fullscreenElement is not supported by this browser")}a(1028);var Ie=[{sceneId:1,link:null},{sceneId:2,link:null},{sceneId:3,link:null},{sceneId:4,link:null},{sceneId:null,link:null},{sceneId:null,link:null},{sceneId:7,link:null},{sceneId:8,link:null},{sceneId:9,link:null},{sceneId:10,link:null},{sceneId:11,link:null},{sceneId:12,link:null},{sceneId:13,link:null},{sceneId:14,link:null},{sceneId:15,link:null},{sceneId:16,link:null},{sceneId:17,link:null},{sceneId:18,link:null},{sceneId:19,link:null},{sceneId:20,link:null},{sceneId:21,link:null},{sceneId:22,link:null}],Ce=[0,0],Le=[50,0],Be=!1;var Te=function(e){var t=e.trigger,a=(e.userhistory,e.setTrigger),r=e.history,l=(r.gameId,r.sceneId,Object(n.useState)()),i=Object(E.a)(l,2),s=i[0],o=i[1];function u(e){Ce=[e.pageX,e.pageY],Be=!0,e.preventDefault()}function m(e){Be=!1,e.preventDefault()}function d(e){Be&&(Ce[0]===e.pageX&&Ce[1]===e.pageY||(Le=[Le[0]-(Ce[0]-e.pageX),Le[1]-(Ce[1]-e.pageY)],o(Le),Ce=[e.pageX,e.pageY])),e.preventDefault()}!function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){},t=Object(n.useState)(!1),a=Object(E.a)(t,2),c=a[0],r=a[1];c||(e(),r(!0))}((function(){o(Le)})),Object(n.useEffect)((function(){var e=document.getElementsByClassName("TreeMap_popup");t?(e[0].addEventListener("mousedown",u),e[0].addEventListener("mouseup",m),e[0].addEventListener("mousemove",d)):e[0]&&(e[0].removeEventListener("mousedown",u),e[0].removeEventListener("mouseup",m),e[0].removeEventListener("mousemove",d))}),[t]);var p=1,f=1,g=0,b=Ie.map((function(e,t){return g===f&&(p+=1,g=0,f*=4),g+=1,c.a.createElement("div",{className:"TreeMap_nodeContainer",style:{width:"25%",height:1/f*100+"%",left:(p-1)/4*100+"%",top:(g-1)/f*100+"%"}},c.a.createElement("div",{className:"TreeMap_node",style:{width:"1rem",height:"1rem"}}),4!==p?c.a.createElement(n.Fragment,null,c.a.createElement("hr",{className:"TreeMap_nodeLine",style:{left:"70%",top:"12.5%"}}),c.a.createElement("hr",{className:"TreeMap_nodeLine",style:{left:"70%",top:"37.5%"}}),c.a.createElement("hr",{className:"TreeMap_nodeLine",style:{left:"70%",top:"62.5%"}}),c.a.createElement("hr",{className:"TreeMap_nodeLine",style:{left:"70%",top:"87.5%"}}),c.a.createElement("hr",{className:"TreeMap_nodeLine",style:{left:"50%",top:"50%"}}),c.a.createElement("hr",{className:"TreeMap_nodeLine_vertical"})):null)}));return t?c.a.createElement("div",{className:"TreeMap_popup"},c.a.createElement("button",{className:"close_btn",onClick:function(){a(!1)}},"close"),c.a.createElement("div",{className:"TreeMap_inner",style:{width:"40%",height:5*Math.pow(4,3)+"%",left:s[0],top:s[1]}},b)):null},De=a(325),Me=a(528),Fe=a.n(Me),Re=a(527),Pe=a.n(Re),ze=a(526),Ue=a.n(ze),Ae=a(326),He=new Audio;He.volume=.5;var Ge=new Audio;Ge.volume=.5;var qe=function(e){var t,a,r,l=Object(i.g)().state,s=l.gameId,u=l.sceneId,m=e.history,p=Object(d.b)(),f=Object(d.c)((function(e){return e.gameplay.isPause})),g=Object(n.useState)(window.innerWidth),b=Object(E.a)(g,2),v=b[0],y=b[1],_=Object(n.useState)(window.innerHeight),O=Object(E.a)(_,2),j=O[0],k=O[1],N=Object(n.useState)(0),S=Object(E.a)(N,2),x=S[0],w=S[1],I=Object(n.useState)({}),C=Object(E.a)(I,2),L=C[0],B=C[1],D=Object(n.useState)(!1),M=Object(E.a)(D,2),F=M[0],R=M[1],P=Object(n.useState)({}),z=Object(E.a)(P,2),U=z[0],A=z[1],H=Object(n.useState)(!1),G=Object(E.a)(H,2),q=G[0],W=G[1],X=Object(n.useState)(!1),Q=Object(E.a)(X,2),Y=Q[0],V=Q[1],K=Object(d.c)((function(e){return e.sync.prevSceneId})),J=Object(n.useRef)(null);!function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){},t=Object(n.useState)(!1),a=Object(E.a)(t,2),c=a[0],r=a[1];c||(e(),r(!0))}((function(){console.log("")}));try{var Z=function(e){var t=c.a.useState(null!=document[we()]),a=Object(E.a)(t,2),n=a[0],r=a[1];return c.a.useLayoutEffect((function(){return document.onfullscreenchange=function(){return r(null!=document[we()])},function(){return document.onfullscreenchange=void 0}})),[n,function(){null!=e.current&&e.current.requestFullscreen().then((function(){r(null!=document[we()])})).catch((function(){r(!1)}))}]}(J),$=Object(E.a)(Z,2);t=$[0],a=$[1]}catch(qe){r="Fullscreen not supported",t=!1,a=void 0}T("Enter",Be),T("Space",Be),T("Digit1",Me),T("Digit2",Me),T("Digit3",Me),T("Digit4",Me),Object(n.useEffect)((function(){At.off("accept_final_change"),At.on("accept_final_change",(function(e){var t=e.sceneId,a=e.title,n=L.nextList?Object(ne.a)(L.nextList):[];n.push({sceneId:t,script:a});var c=Object(ae.a)({},L,{nextList:n});B(c)}))}),[L]);var ee=Object(n.useState)(.5),te=Object(E.a)(ee,2),re=te[0],le=te[1],oe=Object(n.useState)(!1),ue=Object(E.a)(oe,2),me=ue[0],de=ue[1],be=Object(n.useRef)(.5),ve=function(e){le(e),de(0===e),He.volume=e,Ge.volume=e},he=Object(n.useState)(!0),ye=Object(E.a)(he,2),_e=ye[0],Oe=ye[1];function je(e){var t,a;_e&&Oe(!1),(null===(t=L.cutList[e])||void 0===t?void 0:t.bgm.music)&&(e>0&&L.cutList[e-1].bgm.music==L.cutList[e].bgm.music||(He.pause(),He.src=L.cutList[e].bgm.music,He.play())),(null===(a=L.cutList[e])||void 0===a?void 0:a.sound.music)&&(Ge.pause(),Ge.src=L.cutList[e].sound.music,Ge.play())}var ke=Object(n.useState)(!0),Ie=Object(E.a)(ke,2),Ce=Ie[0],Le=Ie[1];function Be(e){!Ce&&x<L.cutList.length-1&&!f&&(je(x+1),w(x+1),Le(!0))}function Me(e){if(x===L.cutList.length-1&&!f)if(L.nextList[parseInt(e.key)-1])m.replace({pathname:"/gameplay",state:{sceneId:L.nextList[parseInt(e.key)-1].sceneId,gameId:s}});else if(parseInt(e.key)-1===L.nextList.length){p(se(!0)),e.preventDefault();var t=document.getElementById("choice");t&&t.click()}}Object(n.useEffect)((function(){At.emit("leave room",{room:K}),At.emit("room",{room:u}),p({type:"SAVE_PREV_SCENE",payload:{prevSceneId:u}.prevSceneId}),At.off("empty_num_changed"),At.on("empty_num_changed",(function(e){p(Se({sceneId:u,emptyNum:e.emptyNum}))})),At.emit("validate_empty_num",{scene_id:u})}),[u]),Object(n.useEffect)((function(){p(xe(!1))}),[]),Object(n.useEffect)((function(){p(se(!!(q||F||Y)))}),[q,F,Y]),Object(n.useEffect)((function(){o.a.get("/api/game/getnextscene/".concat(s,"/").concat(u)).then((function(t){if(t.data.success){var a={gameId:s,sceneId:t.data.sceneIdList};A(a),w(0),He.pause(),Ge.pause(),Oe(!0),B(t.data.scene),p(se(!1)),p(ie(0)),p(ie(6))}else h.a.error("Scene \uc815\ubcf4\uac00 \uc5c6\uc2b5\ub2c8\ub2e4."),e.history.replace("/game/".concat(s))}))}),[u]),Object(n.useEffect)((function(){window.addEventListener("resize",(function(){y(window.innerWidth),k(window.innerHeight)}))}),[window.innerWidth,window.inner]);var Re,ze=t?0:.1;return Re=.5625*v>j?{width:"".concat(j*(1-2*ze)/.5625,"px"),height:"".concat(j*(1-2*ze),"px"),minWidth:"".concat(300/.5625,"px"),minHeight:"".concat(300,"px")}:{width:"".concat(v*(1-2*ze),"px"),height:"".concat(v*(1-2*ze)*.5625,"px"),minWidth:"".concat(300,"px"),minHeight:"".concat(168.75,"px")},Object(n.useEffect)((function(){return p(Se({sceneId:u})),function(){He.pause(),Ge.pause()}}),[]),(null===L||void 0===L?void 0:L.cutList)?(0==x&&_e&&je(0),c.a.createElement("div",{className:"".concat(t?"gamePlay__container_fullscreen":"gamePlay__container"),ref:J},c.a.createElement("div",{className:"".concat(t?"gamePlay__mainContainer_fullscreen":"gamePlay__mainContainer")},c.a.createElement("div",{className:"".concat(t?"backgroundImg_container_fullscreen":"backgroundImg_container"),style:Re,onClick:function(e){return Be()}},c.a.createElement(Ne,null),L.cutList[x]&&L.cutList[x].background?c.a.createElement("img",{className:"backgroundImg",src:L.cutList[x].background,alt:"Network Error"}):c.a.createElement("div",null),c.a.createElement(ce,{characterList:L.cutList[x].characterList}),x===L.cutList.length-1?c.a.createElement(fe,{game_id:s,cut_name:L.cutList[x].name,cut_script:L.cutList[x].script,scene_depth:L.depth,scene_id:L._id,scene_next_list:L.nextList,setIsTyping:Le,isTyping:Ce}):c.a.createElement(pe,{cut_name:L.cutList[x].name,cut_script:L.cutList[x].script,setIsTyping:Le,isTyping:Ce}),c.a.createElement(Ee,{userhistory:m,history:U,trigger:q,setTrigger:W}),c.a.createElement(Te,{userhistory:m,history:U,trigger:Y,setTrigger:V}))),c.a.createElement("div",{className:"gamePlay__btn_container"},c.a.createElement("div",{className:"gamePlay__btn",onClick:function(){me?(de(!1),ve(be.current)):(be.current=re,de(!0),ve(0))}},me?c.a.createElement(Pe.a,null):c.a.createElement(Fe.a,null)),c.a.createElement("div",{style:{width:"80px"}},c.a.createElement(Ue.a,{min:0,max:1,step:.02,value:re,onChange:function(e){ve(e)}})),c.a.createElement("div",null,c.a.createElement("button",{className:"gamePlay__btn",onClick:function(){return W((function(e){return!e}))}},"\ubbf8\ub2c8\ub9f5"),c.a.createElement("button",{className:"gamePlay__btn",onClick:function(){V((function(e){return!e}))}},"\ud2b8\ub9ac\ub9f5"),c.a.createElement("button",{className:"gamePlay__btn",onClick:function(){return R((function(e){return!e}))}},"\uc2e0\uace0")),r?c.a.createElement("button",{onClick:function(){return alert("Fullscreen is unsupported by this browser, please try another browser.")},className:"gamePlay__btn"},r):t?c.a.createElement("button",{onClick:function(){return document.exitFullscreen()},className:"gamePlay__btn"},c.a.createElement(De.a,{icon:Ae.a})):c.a.createElement("button",{onClick:a,className:"gamePlay__btn"},c.a.createElement(De.a,{icon:Ae.b}))),c.a.createElement(ge,{sceneId:u,gameId:s,trigger:F,setTrigger:R}))):c.a.createElement(Ne,null)};a(1033);var We=function(e){var t=e.imgUrl,a=e.setBackgroundImg;return c.a.createElement("div",{onClick:function(){a(t)}},c.a.createElement("img",{src:"".concat(t),alt:"img"}))};var Xe=function(e){var t=e.gameDetail,a=e.setBackgroundImg,n=e.setMakeModalState,r=t.background.map((function(e,t){return c.a.createElement("div",{className:"background",key:"".concat(t)},c.a.createElement(We,{imgUrl:e.image,setBackgroundImg:a}))}));return c.a.createElement("div",{className:"sidebar__container"},c.a.createElement(G.a,{type:"primary",style:{fontSize:"15px"},onClick:function(){n(2)}},"\ucd94\uac00"),c.a.createElement("div",null,r))};function Qe(e){return{type:"select_character",payload:e}}var Ye=function(e){var t=e.character,a=e.index,n=Object(d.b)();return c.a.createElement("div",null,c.a.createElement("div",{onClick:function(){n(Qe(Object(ae.a)({},t,{index:a})))}},c.a.createElement("img",{src:"".concat(t.image_array[0]),alt:"img"})))};var Ve=function(e){var t=e.gameDetail,a=e.setCharacterList,n=e.setMakeModalState,r=e.setName,l=t.character.map((function(e,t){return c.a.createElement("div",{className:"character",key:"".concat(t)},c.a.createElement(Ye,{character:e,index:t,setCharacterList:a,setName:r}))}));return c.a.createElement("div",{className:"sidebar__container"},c.a.createElement(G.a,{type:"primary",style:{fontSize:"15px"},onClick:function(){n(1)}},"\ucd94\uac00"),c.a.createElement("div",null,l))};a(1034);var Ke=function(e){var t=e.bgm_audio,a=e.bgm,n=e.setBgmFile;return c.a.createElement("div",{onClick:function(){n(a),t.src=a.music,t.play()}},c.a.createElement("img",{src:"http://".concat(u,":5000/uploads/music_icon.jpg"),alt:"img"}),a.name)};var Je=function(e){var t=e.gameDetail,a=e.bgm_audio,n=e.setBgmFile,r=e.setMakeModalState,l=t.bgm.map((function(e,t){return c.a.createElement("div",{className:"bgm",key:"".concat(t)},c.a.createElement(Ke,{bgm_audio:a,bgm:e,setBgmFile:n}))}));return c.a.createElement("div",{className:"sidebar__container"},c.a.createElement(G.a,{type:"primary",style:{fontSize:"15px"},onClick:function(){r(3)}},"\ucd94\uac00"),c.a.createElement("div",null,l))};a(1035);var Ze=function(e){var t=e.sound_audio,a=e.sound,n=e.setSoundFile;return c.a.createElement("div",{onClick:function(){n(a),t.src=a.music,t.play()}},c.a.createElement("img",{src:"http://".concat(u,":5000/uploads/music_icon.jpg"),alt:"img"}),a.name)};var $e=function(e){var t=e.gameDetail,a=e.sound_audio,n=e.setSoundFile,r=e.setMakeModalState,l=t.sound.map((function(e,t){return c.a.createElement("div",{className:"sound",key:"".concat(t)},c.a.createElement(Ze,{sound_audio:a,sound:e,setSoundFile:n}))}));return c.a.createElement("div",{className:"sidebar__container"},c.a.createElement(G.a,{type:"primary",style:{fontSize:"15px"},onClick:function(){r(4)}},"\ucd94\uac00"),c.a.createElement("div",null,l))},et=(a(181),function(e){var t=e.setTag,a=e.tag;return c.a.createElement("div",{className:"tabs"},c.a.createElement("div",{className:"".concat(1===a?"tab is-selected":"tab"),onClick:function(){return t(1)}},"Character"),c.a.createElement("div",{className:"".concat(2===a?"tab is-selected":"tab"),onClick:function(){return t(2)}},"Background"),c.a.createElement("div",{className:"".concat(3===a?"tab is-selected":"tab"),onClick:function(){return t(3)}},"Bgm"),c.a.createElement("div",{className:"".concat(4===a?"tab is-selected":"tab"),onClick:function(){return t(4)}},"Sound"))}),tt=a(1112);a(1036);var at=function(e){var t=e.onDrop,a=e.multiple,n=e.maxSize,r=e.accept;return c.a.createElement(K.a,{onDrop:t,multiple:a,maxSize:n,accept:r},(function(e){var t=e.getRootProps,a=e.getInputProps;return c.a.createElement("div",Object.assign({className:"dropzone"},t()),c.a.createElement("input",a()),c.a.createElement(tt.a,{className:"dropzone-icon"}))}))},nt=a(1113),ct=a(1114),rt=(a(1037),U.a.TextArea);var lt=function(e){var t=e.blobGame,a=e.setBlobGame,r=e.charPageNum,l=e.setCharFileQueue,i=e.setCharBlobList,s=Object(n.useState)([]),o=Object(E.a)(s,2),u=o[0],m=o[1],d=Object(n.useState)(0),p=Object(E.a)(d,2),f=p[0],g=p[1],b=Object(n.useRef)(0),v=function(e){a((function(t){return t.character[r.current].name=e.currentTarget.value,t})),g((function(e){return e+1}))},y=function(e){a((function(t){return t.character[r.current].description=e.currentTarget.value,t})),g((function(e){return e+1}))},_=function(e){for(var n=function(){if(!e[c])return h.a.error("10MB \uc774\ud558\uc758 \uc774\ubbf8\uc9c0 \ud30c\uc77c\uc744 \uc5c5\ub85c\ub4dc\ud574\uc8fc\uc138\uc694."),{v:void 0};var n=URL.createObjectURL(e[c]);i((function(e){return[].concat(Object(ne.a)(e),[n])})),"-1"===b.current?(a((function(e){return e.character=[].concat(Object(ne.a)(e.character),[{name:"",description:"",image_array:[n]}]),e})),b.current=t.character.length-1):a((function(e){return e.character[b.current].image_array=[].concat(Object(ne.a)(e.character[b.current].image_array),[n]),e}))},c=0;c<e.length;c++){var r=n();if("object"===typeof r)return r.v}l((function(t){return[].concat(Object(ne.a)(t),[{index:Number(b.current),array:e}])})),g((function(e){return e+1}))};return Object(n.useEffect)((function(){if(t.character&&r.current<t.character.length){var e=t.character[r.current].image_array.map((function(e,a){return c.a.createElement("div",{id:r.current,className:"largeBox",key:a},c.a.createElement("img",{className:"smallBox",src:e,alt:"img"}),0===a&&c.a.createElement(z.a,null,c.a.createElement("label",null,"\uc774\ub984"),c.a.createElement(U.a,{onChange:v,value:t.character[r.current].name}),c.a.createElement("label",null,"\uc0c1\uc138\uc124\uc815"),c.a.createElement(rt,{onChange:y,value:t.character[r.current].description})),a===t.character[r.current].image_array.length-1&&c.a.createElement(at,{onDrop:_,multiple:!0,maxSize:10485761,accept:"image/*"}))}));m(e)}else m("")}),[f,t]),me("mousedown",(function(e){for(var t=0;t<e.path.length;t++)if(e.path[t].id)return void(b.current=e.path[t].id)})),c.a.createElement("div",null,c.a.createElement("div",{className:"character-container"},0!==u&&c.a.createElement("div",null,u)),t.character&&r.current===t.character.length&&c.a.createElement("div",{id:-1},c.a.createElement(at,{onDrop:_,multiple:!0,maxSize:10485761,accept:"image/*"})),0!==r.current&&c.a.createElement(nt.a,{style:{fontSize:"3rem"},onClick:function(){r.current--,g((function(e){return e+1}))},twoToneColor:"#52c41a"}),t.character&&r.current!==t.character.length&&c.a.createElement(ct.a,{style:{fontSize:"3rem"},onClick:function(){r.current++,g((function(e){return e+1}))},twoToneColor:"#52c41a"}),t.character&&c.a.createElement("div",null," ",r.current,"/",t.character.length))};a(1038);var it=function(e){var t=e.game,a=e.setFileQueue,r=e.setTypeQueue,l=e.setBackBlobList,i=e.backBlobList,s=Object(n.useState)([]),o=Object(E.a)(s,2),u=o[0],m=o[1],d=Object(n.useState)([]),p=Object(E.a)(d,2),f=p[0],g=p[1];return Object(n.useEffect)((function(){t.background&&m(t.background.map((function(e,t){return c.a.createElement("div",{className:"largeBox1",key:t},c.a.createElement("img",{className:"smallBox12",src:e.image,alt:"img"}))})))}),[t]),Object(n.useEffect)((function(){i&&g(i.map((function(e,t){return c.a.createElement("div",{className:"largeBox1",key:t},c.a.createElement("img",{className:"smallBox12",src:e,alt:"img"}))})))}),[i]),c.a.createElement("div",null,c.a.createElement(at,{onDrop:function(e){for(var t=0;t<e.length;t++){if(!e[t])return void h.a.error("10MB \uc774\ud558\uc758 \uc774\ubbf8\uc9c0 \ud30c\uc77c\uc744 \uc5c5\ub85c\ub4dc\ud574\uc8fc\uc138\uc694.");a((function(a){return[].concat(Object(ne.a)(a),[e[t]])})),r((function(e){return[].concat(Object(ne.a)(e),[1])})),l((function(a){return[].concat(Object(ne.a)(a),[URL.createObjectURL(e[t])])}))}},multiple:!0,maxSize:10485761,accept:"image/*"}),c.a.createElement("div",{className:"background-container"},0!==u&&c.a.createElement("div",null,u),0!==f&&c.a.createElement("div",null,f)))};a(496);var st=function(e){var t=e.game,a=e.setFileQueue,r=e.setTypeQueue,l=e.setBgmBlobList,i=e.bgmBlobList,s=e.setBgmBlobNames,o=e.bgmBlobNames,m=Object(n.useState)([]),d=Object(E.a)(m,2),p=d[0],f=d[1],g=Object(n.useState)([]),b=Object(E.a)(g,2),v=b[0],y=b[1];return Object(n.useEffect)((function(){t.bgm&&f(t.bgm.map((function(e,t){return c.a.createElement("div",{className:"largeBox13",key:t},(t+1)%2?c.a.createElement("div",null,c.a.createElement("img",{className:"smallBox13",src:"http://".concat(u,":5000/uploads/music_icon.jpg"),alt:"img"}),e.name):c.a.createElement("div",null,c.a.createElement("img",{className:"smallBox23",src:"http://".concat(u,":5000/uploads/music_icon.jpg"),alt:"img"}),e.name))})))}),[t]),Object(n.useEffect)((function(){i&&y(i.map((function(e,t){return c.a.createElement("div",{className:"largeBox13",key:t},(t+1)%2?c.a.createElement("div",null,c.a.createElement("img",{className:"smallBox13",src:"http://".concat(u,":5000/uploads/music_icon.jpg"),alt:"img"}),o[t].name):c.a.createElement("div",null,c.a.createElement("img",{className:"smallBox23",src:"http://".concat(u,":5000/uploads/music_icon.jpg"),alt:"img"}),o[t].name))})))}),[i]),c.a.createElement("div",null,c.a.createElement(at,{onDrop:function(e){for(var t=0;t<e.length;t++){if(!e[t])return void h.a.error("10MB \uc774\ud558\uc758 \uc74c\uc6d0 \ud30c\uc77c\uc744 \uc5c5\ub85c\ub4dc\ud574\uc8fc\uc138\uc694.");a((function(a){return[].concat(Object(ne.a)(a),[e[t]])})),r((function(e){return[].concat(Object(ne.a)(e),[2])})),s((function(a){return[].concat(Object(ne.a)(a),[e[t]])})),l((function(a){return[].concat(Object(ne.a)(a),[URL.createObjectURL(e[t])])}))}},multiple:!0,maxSize:10485761,accept:"audio/*"}),c.a.createElement("div",{className:"music-container"},0!==p&&c.a.createElement("div",null,p),0!==v&&c.a.createElement("div",null,v)))};var ot=function(e){var t=e.game,a=e.setFileQueue,r=e.setTypeQueue,l=e.setSoundBlobList,i=e.soundBlobList,s=e.setSoundBlobNames,o=e.soundBlobNames,m=Object(n.useState)([]),d=Object(E.a)(m,2),p=d[0],f=d[1],g=Object(n.useState)([]),b=Object(E.a)(g,2),v=b[0],y=b[1];return Object(n.useEffect)((function(){t.sound&&f(t.sound.map((function(e,t){return c.a.createElement("div",{className:"largeBox13",key:t},(t+1)%2?c.a.createElement("div",null,c.a.createElement("img",{className:"smallBox13",src:"http://".concat(u,":5000/uploads/music_icon.jpg"),alt:"img"}),e.name):c.a.createElement("div",null,c.a.createElement("img",{className:"smallBox23",src:"http://".concat(u,":5000/uploads/music_icon.jpg"),alt:"img"}),e.name))})))}),[t]),Object(n.useEffect)((function(){i&&y(i.map((function(e,t){return c.a.createElement("div",{className:"largeBox13",key:t},(t+1)%2?c.a.createElement("div",null,c.a.createElement("img",{className:"smallBox13",src:"http://".concat(u,":5000/uploads/music_icon.jpg"),alt:"img"}),o[t].name):c.a.createElement("div",null,c.a.createElement("img",{className:"smallBox23",src:"http://".concat(u,":5000/uploads/music_icon.jpg"),alt:"img"}),o[t].name))})))}),[i]),c.a.createElement("div",null,c.a.createElement(at,{onDrop:function(e){for(var t=0;t<e.length;t++){if(!e[t])return void h.a.error("10MB \uc774\ud558\uc758 \uc74c\uc6d0 \ud30c\uc77c\uc744 \uc5c5\ub85c\ub4dc\ud574\uc8fc\uc138\uc694.");a((function(a){return[].concat(Object(ne.a)(a),[e[t]])})),r((function(e){return[].concat(Object(ne.a)(e),[3])})),s((function(a){return[].concat(Object(ne.a)(a),[e[t]])})),l((function(a){return[].concat(Object(ne.a)(a),[URL.createObjectURL(e[t])])}))}},multiple:!0,maxSize:10485761,accept:"audio/*"}),c.a.createElement("div",{className:"music-container"},0!==p&&c.a.createElement("div",null,p),0!==v&&c.a.createElement("div",null,v)))},ut=a(319),mt=a.n(ut),dt=a(219),pt=function(e){var t=e.gameId,a=e.visible,r=e.setTag,l=e.tag,i=e.setReload,s=Object(n.useState)([]),u=Object(E.a)(s,2),m=u[0],d=u[1],p=Object(n.useState)([]),f=Object(E.a)(p,2),g=f[0],b=f[1],v=Object(n.useState)([]),y=Object(E.a)(v,2),_=y[0],O=y[1],j=Object(n.useState)([]),k=Object(E.a)(j,2),N=k[0],S=k[1],x=Object(n.useState)([]),w=Object(E.a)(x,2),I=w[0],C=w[1],L=Object(n.useState)([]),B=Object(E.a)(L,2),T=B[0],D=B[1],M=Object(n.useState)([]),F=Object(E.a)(M,2),R=F[0],P=F[1],z=Object(n.useState)([]),U=Object(E.a)(z,2),A=U[0],H=U[1],G=Object(n.useState)([]),q=Object(E.a)(G,2),W=q[0],X=q[1],Q=Object(n.useRef)(0),Y=Object(n.useState)([]),V=Object(E.a)(Y,2),K=V[0],J=V[1],Z=Object(n.useState)([]),$=Object(E.a)(Z,2),ee=$[0],te=$[1],ae={gameId:t};Object(n.useEffect)((function(){o.a.post("/api/game/getgamedetail",ae).then((function(e){e.data.success?(d(e.data.gameDetail),X(mt.a.cloneDeep(e.data.gameDetail))):alert("\uac8c\uc784 \uc815\ubcf4\ub97c \ub85c\ub529\ud558\ub294\ub370 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4.")}))}),[]);var ne=function(){ee.forEach((function(e){e&&URL.revokeObjectURL(e)})),N.forEach((function(e){e&&URL.revokeObjectURL(e)})),I.forEach((function(e){e&&URL.revokeObjectURL(e)})),R.forEach((function(e){e&&URL.revokeObjectURL(e)}))},ce=!1,le=function(){var e,t;K.length?function(){var a=Array.from({length:W.character.length},(function(){return 0})),n=new FormData;for(e=0;e<W.character.length;e++)for(t=0;t<K.length;t++)K[t].index===e&&(a[e]+=K[t].array.length,K[t].array.forEach((function(e){n.append("files",e)})));o.a.post("/api/game/uploadfile",n,{header:{encrpyt:"multipart/form-data"}}).then((function(e){e.data.success?ie(a,e.data.files):alert("\uce90\ub9ad\ud130 DB \uc5c5\ub85c\ub4dc \uc2e4\ud328")}))}():ie(null,null)},ie=function(e,a){console.log("production");for(var n=0,c=0;c<W.character.length;c++)if(m.character[c]||m.character.push({name:"",description:"",image_array:[]}),m.character[c].name=W.character[c].name,m.character[c].description=W.character[c].description,e){for(var l=n;l<n+e[c];l++)console.log("".concat(dt.STORAGE,"/").concat(a[l].path)),m.character[c].image_array.push(a[l].location);n+=e[c]}var s={gameId:t,character:m.character};console.log(m.character),o.a.post("/api/game/putCharDB",s).then((function(e){e.data.success?g.length||(i((function(e){return e+1})),r(0)):h.a.error("DB \uc5c5\ub370\uc774\ud2b8 \uc2e4\ud328")}))},se=function(){var e=new FormData;g.forEach((function(t){e.append("files",t)}));o.a.post("/api/game/uploadfile",e,{header:{encrpyt:"multipart/form-data"}}).then((function(e){e.data.success?oe(e.data.files):alert("\uc5c5\ub85c\ub4dc \uc2e4\ud328")}))},oe=function(e){for(var a={gameId:t,background:[],bgm:[],sound:[]},n=0;n<e.length;n++)switch(_[n]){case 1:a.background.push({name:e[n].originalname,image:e[n].location});break;case 2:a.bgm.push({name:e[n].originalname,music:e[n].location});break;case 3:a.sound.push({name:e[n].originalname,music:e[n].location});break;default:h.a.error("\uc815\uc758\ub418\uc9c0 \uc54a\uc740 \uc5c5\ub85c\ub4dc \ubc84\ud2bc\uc785\ub2c8\ub2e4.")}o.a.post("/api/game/putDB",a).then((function(e){e.data.success?(i((function(e){return e+1})),r(0)):h.a.error("DB \uc5c5\ub370\uc774\ud2b8 \uc2e4\ud328")}))};return c.a.createElement(re.a,{className:"scenemake_modal",visible:a,okText:"Upload",onCancel:function(){ne(),r(0)},onOk:function(){ce||(ce=!0,ne(),le(),g.length&&se())},width:1e3,style:{top:20}},c.a.createElement(et,{setTag:r,tag:l}),1===l&&c.a.createElement(lt,{blobGame:W,setBlobGame:X,charPageNum:Q,setCharFileQueue:J,setCharBlobList:te}),2===l&&c.a.createElement(it,{game:m,setFileQueue:b,setTypeQueue:O,setBackBlobList:S,backBlobList:N}),3===l&&c.a.createElement(st,{game:m,setFileQueue:b,setTypeQueue:O,setBgmBlobList:C,bgmBlobList:I,setBgmBlobNames:D,bgmBlobNames:T}),4===l&&c.a.createElement(ot,{game:m,setFileQueue:b,setTypeQueue:O,setSoundBlobList:P,soundBlobList:R,setSoundBlobNames:H,soundBlobNames:A}))},ft=U.a.TextArea,gt=[{value:0,label:"Private"},{value:1,label:"Public"}],bt=[{value:0,label:"\uc0b4\uc544\ub0a8\uae30"},{value:1,label:"\ub85c\ub9e8\uc2a4"},{value:2,label:"\uc2a4\ud1a0\ub9ac"},{value:3,label:"\ucd94\ub9ac"},{value:4,label:"\ubcd1\ub9db"}],vt=function(e){var t=e.gameId,a=e.visible,r=e.setUploadModalState,l=e.onSubmit_saveScene,i=Object(d.c)((function(e){return e.user})),s=Object(n.useState)(""),u=Object(E.a)(s,2),m=u[0],p=u[1],f=Object(n.useState)(""),g=Object(E.a)(f,2),b=g[0],v=g[1],y=Object(n.useState)(0),_=Object(E.a)(y,2),O=_[0],j=_[1],k=Object(n.useState)(bt[0].label),N=Object(E.a)(k,2),S=N[0],x=N[1],w=Object(n.useState)(""),I=Object(E.a)(w,2),C=I[0],L=I[1],B=Object(n.useState)([]),T=Object(E.a)(B,2),D=T[0],M=T[1],F=function(e){e.preventDefault(),""!==m&&""!==b&&""!==C?(R(),r(!1),l()):h.a.error("\ubaa8\ub4e0 \uc815\ubcf4\ub97c \uc785\ub825\ud574\uc8fc\uc138\uc694.")},R=function(){URL.revokeObjectURL(C);var e=new FormData;D.forEach((function(t){e.append("files",t)})),o.a.post("/api/game/uploadfile",e,{header:{encrpyt:"multipart/form-data"}}).then((function(e){e.data.success?P(e.data.files[0].location):h.a.error("\uc5c5\ub85c\ub4dc \uc2e4\ud328")}))},P=function(e){var a={gameId:t,creator:i.userData._id,title:m,description:b,thumbnail:e,privacy:O,category:S,writer:[i.userData._id]};o.a.post("/api/game/uploadgameInfo",a).then((function(e){e.data.success||h.a.error("game\uc81c\uc791 \uc2e4\ud328")}))};return c.a.createElement(re.a,{className:"scenemake_modal",visible:a,okText:"Upload",onCancel:function(){C&&URL.revokeObjectURL(C),r(!1)},onOk:F,width:1e3,style:{top:20}},c.a.createElement("div",null,c.a.createElement("label",null,"Upload Game"),c.a.createElement(z.a,{onSubmit:F},c.a.createElement("div",{style:{display:"flex"}},c.a.createElement(at,{onDrop:function(e){e[0]?(URL.revokeObjectURL(C),L(URL.createObjectURL(e[0])),M(e)):h.a.error("10MB \uc774\ud558\uc758 \uc774\ubbf8\uc9c0 \ud30c\uc77c\uc744 \uc5c5\ub85c\ub4dc\ud574\uc8fc\uc138\uc694.")},multiple:!1,maxSize:10485761,accept:"image/*"}),C&&c.a.createElement("div",null,c.a.createElement("img",{className:"thumbnail__img",src:C,alt:"thumbnail"}))),c.a.createElement("label",null,"Title"),c.a.createElement(U.a,{onChange:function(e){p(e.currentTarget.value)},value:m}),c.a.createElement("label",null,"Description"),c.a.createElement(ft,{onChange:function(e){v(e.currentTarget.value)},value:b}),c.a.createElement("select",{onChange:function(e){j(e.currentTarget.value)}},gt.map((function(e,t){return c.a.createElement("option",{key:t,value:e.value},e.label)}))),c.a.createElement("select",{onChange:function(e){var t=e.currentTarget.value;x(e.currentTarget[t].text)}},bt.map((function(e,t){return c.a.createElement("option",{key:t,value:e.value},e.label)}))))))},Et=(a(1039),{}),ht=function(e,t,a,n){e in Et||(Et[e]={}),t in Et[e]||(Et[e][t]=[]),Et[e][t].push([a,n]),e.addEventListener(t,a,n)},yt=function(e,t){if(e in Et){var a=Et[e];if(t in a)for(var n=a[t],c=n.length;c--;){var r=n[c];e.removeEventListener(t,r[0],r[1])}}};var _t=Object(n.memo)((function(e){var t=Object(d.b)(),a=e.charSchema,r=e.GameCharacterList,l=e.setCharacterList,i=e.index,s=(e.CharacterList,Object(n.useRef)()),o=Object(n.useRef)(),u=Object(n.useState)(!0),m=Object(E.a)(u,2),p=m[0],f=(m[1],Object(n.useState)(!0)),g=Object(E.a)(f,2),b=g[0],v=g[1],h=Object(n.useState)(!1),y=Object(E.a)(h,2),_=y[0],O=y[1],j=Object(n.useState)(0),k=Object(E.a)(j,2),N=k[0],S=k[1],x=document.getElementById("backgroundImg_container"),w=[0,0],I=!1;function C(e){var t=[e.pageX,e.pageY];if(I&&p&&b){if(w[0]-e.pageX>3||w[1]-e.pageY>3||w[0]-e.pageX<-3||w[1]-e.pageY<-3){var a=x.offsetWidth,n=x.offsetHeight,c=Number(s.current.style.left.replace(/%/g,"")),r=Number(o.current.style.top.replace(/%/g,"").replace(/px/g,"")),l=c+100*(e.pageX-w[0])/a,u=r+100*(e.pageY-w[1])/n;s.current.style.left=String(l)+"%",o.current.style.top=String(u)+"%",w=t}}else if(I&&p&&_&&(w[0]-e.pageX>7||w[0]-e.pageX<-7)){var m=document.getElementById("".concat(i)).offsetWidth,d=Number(o.current.style.height.replace(/%/g,"")),f=0;(f=(w[0],d*(m-1*(w[0]-t[0]))/m))>20&&(o.current.style.height=String(f)+"%"),w=t}S(document.getElementById("".concat(i)).offsetWidth),e.stopPropagation(),e.preventDefault()}Object(n.useEffect)((function(){return ht(x,"mousemove",C,!1),ht(x,"mouseup",B,!1),S(document.getElementById("".concat(i)).offsetWidth),function(){yt(x,"mousemove"),yt(x,"mouseup")}}),[]);var L=function(e){ht(x,"mousemove",C,!1),ht(x,"mouseup",B,!1),w=[e.pageX,e.pageY],I=!0},B=function(e){yt(x,"mousemove"),yt(x,"mouseup"),l((function(e){return[].concat(Object(ne.a)(e.slice(0,i)),[Object(ae.a)({},e[i],{posX:Number(s.current.style.left.replace(/%/g,"")),posY:Number(o.current.style.top.replace(/%/g,"").replace(/px/g,""))})],Object(ne.a)(e.slice(i+1,4)))})),l((function(e){return[].concat(Object(ne.a)(e.slice(0,i)),[Object(ae.a)({},e[i],{size:Number(o.current.style.height.replace(/%/g,""))})],Object(ne.a)(e.slice(i+1,4)))})),w=[e.pageX,e.pageY],I=!1,O(!1),v(!0),t(Qe(Object(ae.a)({},r[a.index],{index:a.index})))};return c.a.createElement("div",{ref:s,key:i,className:"CharacterBlock",style:{left:"".concat(a.posX,"%")}},c.a.createElement("div",{ref:o,className:"character__container",style:{height:"".concat(a.size,"%"),top:"".concat(a.posY,"%")}},c.a.createElement("img",{onMouseDown:L,className:"".concat(p?"characterImg_clicked":"characterImg"),id:"".concat(i),src:a.image,alt:"img"}),c.a.createElement("div",{className:"".concat(_?"btn_sizing_clicked":"btn_sizing"),onMouseOver:function(e){v(!1),O(!0)},onMouseOut:function(e){v(!0),O(!1)},onMouseDown:L,style:{left:"".concat(N-3,"px")}})))})),Ot=(a(1040),Object(n.memo)((function(e){var t=e.onRemove_character,a=e.CharacterList,n=e.GameCharacterList,r=e.setCharacterList,l=a.map((function(e,l){return c.a.createElement("div",{key:l},c.a.createElement(_t,{setCharacterList:r,GameCharacterList:n,onRemove_character:t,CharacterList:a,index:l,charSchema:e}))}));return a.length>0&&c.a.createElement("div",{className:"CharacterBlocks",id:"CharacterBlocks"},l)})));a(1041);var jt=function(e){var t=e.setName,a=e.character,n=e.setCharacterList,r=e.CharacterList,l=e.GameCharacterList,i=Object(d.b)(),s=r.map((function(e,a){return c.a.createElement("div",{key:a,className:"characterList_Info",onClick:function(){!function(e){t(l[e].name),i(Qe(Object(ae.a)({},l[e],{index:e})))}(e.index)}},c.a.createElement("img",{src:e.image,alt:"",className:"characterList_Image"}))})),o=a.image_array.map((function(e,r){return c.a.createElement("div",{key:r,onClick:function(){!function(e,c){var r={index:a.index,image:c,posX:0,posY:0,reverse:0,size:50};n((function(e){for(var t=0;t<e.length;t++)if(e[t].index===a.index)return[].concat(Object(ne.a)(e.slice(0,t)),[Object(ae.a)({},e[t],{image:c})],Object(ne.a)(e.slice(t+1,4)));return e.length>=3?(h.a.info("\uc778\ubb3c\uc740 \ucd5c\ub300 \uc138\uba85\uae4c\uc9c0 \ucd94\uac00 \uac00\ub2a5\ud569\ub2c8\ub2e4."),e):[].concat(Object(ne.a)(e),[r])})),t(a.name)}(0,e)}},c.a.createElement("img",{src:e,alt:"img"}))}));return c.a.createElement("div",{className:"characterInfo__container"},c.a.createElement("div",{className:"characterList__container"},s),c.a.createElement("div",null,"\uc774\ub984 : ",a.name),c.a.createElement("div",null,"\uc815\ubcf4 : ",a.description),c.a.createElement("img",{src:a.image_array[0],alt:"",className:"main_img"}),c.a.createElement("div",{className:"image_array__container"},o))};a(1042);var kt=function(e){var t=e.setCharacterList,a=e.CharacterList,r=e.GameCharacterList,l=e.setName,i=Object(d.b)(),s=Object(d.c)((function(e){return e.character})),o=Object(n.useState)(!1),u=Object(E.a)(o,2),m=u[0],p=u[1];return Object(n.useEffect)((function(){for(var e=0,t=0;t<a.length;t++)if(a[t].index===s.characterSelected.index){e=1;break}p(1===e)}),[s,a]),c.a.createElement("div",{className:"modal_Character"},c.a.createElement("div",{onClick:function(){i({type:"detach_character"})}},"\uce90\ub9ad\ud130 \uc120\ud0dd \ud574\uc81c"),m&&c.a.createElement("div",{onClick:function(){t((function(e){for(var t=0;t<e.length;t++)if(e[t].index===s.characterSelected.index)return h.a.info("\uc0ad\uc81c\ub418\uc5c8\uc2b5\ub2c8\ub2e4."),[].concat(Object(ne.a)(e.slice(0,t)),Object(ne.a)(e.slice(t+1,4)))})),l("")}},"\uc0ad\uc81c"),c.a.createElement(jt,{setName:l,GameCharacterList:r,character:s.characterSelected,setCharacterList:t,CharacterList:a}))},Nt=a(1102);a(1043);var St=function(e){var t=e.CutList,a=e.CutNumber,n=e.displayCut,r=e.setCutNumber,l=e.Hover,i=e.setHover,s=e.EmptyCutList,o=e.saveCut,u=function(e){if(a>29)return n(e),void r(e);a!==e&&(o(),n(e),r(e))},m=t.map((function(e,t){return a===t?c.a.createElement("div",{className:"sceneMake__CurrentSceneBox",key:"".concat(t)}):l?c.a.createElement("div",{className:"sceneMake__SceneBox_color",key:"".concat(t),onMouseOver:function(){return u(t)}}):c.a.createElement("div",{className:"sceneMake__SceneBox_color",key:"".concat(t),onClick:function(){return u(t)}})})),d=s.map((function(e,n){return a-t.length===n?c.a.createElement("div",{className:"sceneMake__CurrentSceneBox",key:"".concat(n)}):c.a.createElement("div",{className:"sceneMake__EmptySceneBox",key:"".concat(n)})}));return c.a.createElement("div",{className:"sceneMake__sceneBox_container"},c.a.createElement("div",{className:"sceneMake__sceneBox"},m,d),c.a.createElement("div",null,c.a.createElement(Nt.a,{checked:l,checkedChildren:a,unCheckedChildren:a,onChange:function(){i((function(e){return!e}))},size:"small"})))},xt=a(1115),wt=a(1116),It=a(1117),Ct=(a(1045),new Audio),Lt=new Audio,Bt=function(e){var t=Object(d.b)(),a=Object(i.f)(),r=Object(i.g)(),l=r.state,s=l.gameId,m=l.sceneId;void 0===r.state&&window.history.back();var p,f=Object(d.c)((function(e){return e.user})),g=Object(n.useState)(window.innerWidth),y=Object(E.a)(g,2),_=y[0],O=y[1],j=Object(n.useState)(window.innerHeight),k=Object(E.a)(j,2),N=k[0],S=k[1],x=Object(n.useState)({}),w=Object(E.a)(x,2),I=w[0],C=w[1],L=Object(n.useState)(0),B=Object(E.a)(L,2),D=B[0],M=B[1],F=Object(n.useState)(1),R=Object(E.a)(F,2),P=R[0],z=R[1],U=Object(n.useState)(!1),A=Object(E.a)(U,2),H=A[0],q=A[1],W=Object(n.useState)(!0),X=Object(E.a)(W,2),Q=X[0],Y=X[1],V=Object(n.useState)([]),K=Object(E.a)(V,2),J=K[0],Z=K[1],$=Object(n.useState)("http://".concat(u,":5000/uploads/defaultBackground.png")),ee=Object(E.a)($,2),te=ee[0],ae=ee[1],ce=Object(n.useState)(""),re=Object(E.a)(ce,2),le=re[0],se=re[1],oe=Object(n.useState)(""),ue=Object(E.a)(oe,2),me=ue[0],de=ue[1],pe=Object(n.useState)({name:"",music:""}),fe=Object(E.a)(pe,2),ge=fe[0],be=fe[1],ve=Object(n.useState)({name:"",music:""}),Ee=Object(E.a)(ve,2),he=Ee[0],ye=Ee[1],_e=Object(n.useState)(!1),Oe=Object(E.a)(_e,2),je=Oe[0],ke=Oe[1],Ne=Object(n.useState)(0),Se=Object(E.a)(Ne,2),we=Se[0],Ie=Se[1],Ce=Object(n.useState)(!1),Le=Object(E.a)(Ce,2),Be=Le[0],Te=Le[1],De=Object(n.useState)([]),Me=Object(E.a)(De,2),Fe=Me[0],Re=Me[1],Pe=Object(n.useState)(Array.from({length:30},(function(){return 0}))),ze=Object(E.a)(Pe,2),Ue=ze[0],Ae=ze[1];Object(n.useEffect)((function(){t(xe(!1))}),[]),Object(n.useEffect)((function(){f.userData&&(At.emit("leave room",{room:f.userData._id.toString()}),At.emit("room",{room:f.userData._id.toString()})),At.off("timeout_making"),At.on("timeout_making",(function(t){e.history.replace("/")}))}),[f]),Object(n.useEffect)((function(){Object(v.a)(b.a.mark((function a(){var n,c,r;return b.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,o.a.get("/api/game/getSceneInfo/".concat(m));case 2:if(!(n=a.sent).data.success){a.next=7;break}p=n.data.scene,a.next=9;break;case 7:return e.history.replace("/"),a.abrupt("return");case 9:p.cutList.length?(p.isFirst&&ke(!0),Re(p.cutList),c=p.cutList[0],Z(c.characterList),ae(c.background),de(c.name),se(c.script),Ie(p.cutList.length-1),t(ie(0)),t(ie(1))):p.isFirst?ke(!0):(r={sceneId:p.prevSceneId},o.a.post("/api/scene/scenedetail",r).then((function(e){if(e.data.success){var a=e.data.lastCut;Z(a.characterList),ae(a.background),de(a.name),t(ie(0)),t(ie(1))}else h.a.error("\uc774\uc804 Scene\uc758 \uc815\ubcf4\ub97c \ubd88\ub7ec\uc624\ub294\ub370 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4.")})));case 10:case"end":return a.stop()}}),a)})))()}),[]);var He=Object(n.useRef)(),Ge=Object(n.useRef)(),qe=Object(n.useRef)(),We=Object(n.useRef)(),Qe=function(e){Ye(),e.current.style.display="block"},Ye=function(){He.current.style.display="none",Ge.current.style.display="none",qe.current.style.display="none",We.current.style.display="none"};T("Enter",(function(e){et(e)}));var Ke=function(){var e={characterList:J,background:te,script:le,name:me,bgm:ge,sound:he};be({name:"",music:""}),ye({name:"",music:""}),Re((function(t){return[].concat(Object(ne.a)(t.slice(0,we)),[e],Object(ne.a)(t.slice(we+1,31)))})),Fe.length===we&&Ae((function(e){return Object(ne.a)(e.slice(0,Ue.length-1))}))},Ze=function(e){Z(Fe[e].characterList),ae(Fe[e].background),se(Fe[e].script),de(Fe[e].name),be(Fe[e].bgm),ye(Fe[e].sound),Fe[e].bgm.music?(Ct.src=Fe[e].bgm.music,Ct.play()):Ct.pause(),Fe[e].sound.music?(Lt.src=Fe[e].sound.music,Lt.play()):Lt.pause()},et=function(e){e.preventDefault(),we>29?h.a.error("\ub354\uc774\uc0c1 Cut\uc744 \uc0dd\uc131\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4."):(24===we&&h.a.warning("\uc0dd\uc131 \uac00\ub2a5\ud55c Cut\uc774 5\uac1c \ub0a8\uc558\uc2b5\ub2c8\ub2e4."),Ke(),we<Fe.length-1?Ze(we+1):se(""),Ie((function(e){return e+1})))},tt=function(){var n=Object(v.a)(b.a.mark((function n(c){var r,l,i,u,d,p=arguments;return b.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(r=p.length>1&&void 0!==p[1]?p[1]:0,!(Fe.length<1)){n.next=4;break}return h.a.error("\ucd5c\uc18c 2\uac1c\uc758 \ucef7\uc744 \uc0dd\uc131\ud574\uc8fc\uc138\uc694."),n.abrupt("return");case 4:if(l={characterList:J,background:te,script:le,name:me,bgm:ge,sound:he},i=[].concat(Object(ne.a)(Fe.slice(0,we)),[l],Object(ne.a)(Fe.slice(we+1,31))),!window.confirm("\uac8c\uc784 \uc81c\uc791\uc744 \uc644\ub8cc\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?")){n.next=25;break}return u={gameId:s,sceneId:m,cutList:i,isTmp:r},n.next=10,o.a.post("/api/scene/save",u);case 10:if(!(d=n.sent).data.success){n.next=16;break}t({type:"detach_character"}),h.a.loading("\uac8c\uc784 \uc5c5\ub85c\ub4dc \uc911..",1).then((function(){r?h.a.success("\uc5c5\ub85c\ub4dc \uc131\uacf5."):h.a.success("\uac8c\uc784 \uc81c\uc791\uc774 \uc644\ub8cc\ub418\uc5c8\uc2b5\ub2c8\ub2e4.",1)})).then((function(){!r&&je?a.replace("/game/".concat(s)):r||(At.emit("final_submit",{prevSceneId:d.data.scene.prevSceneId,sceneId:d.data.scene._id,title:d.data.scene.title,userId:f.userData._id.toString()}),a.replace({pathname:"/gameplay",state:{sceneId:d.data.scene._id,gameId:s}}))})),n.next=23;break;case 16:if("expired"!==d.data.msg){n.next=22;break}return h.a.error("\uc81c\uc791 \uc720\ud6a8\uae30\uac04\uc774 \ub9cc\ub8cc\ub418\uc5c8\uc2b5\ub2c8\ub2e4..",1),e.history.replace({pathname:"/gameplay",state:{sceneId:d.data.prevSceneId,gameId:s}}),n.abrupt("return");case 22:h.a.error("DB\uc5d0 \ubb38\uc81c\uac00 \uc788\uc2b5\ub2c8\ub2e4.");case 23:n.next=26;break;case 25:h.a.error("\uc81c\ucd9c \ucde8\uc18c\uc694");case 26:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),at=Object(n.useState)([]),nt=Object(E.a)(at,2),ct=nt[0],rt=nt[1],lt=Object(n.useState)([]),it=Object(E.a)(lt,2),st=it[0],ot=it[1];Object(n.useEffect)((function(){o.a.post("/api/game/getgamedetail",{gameId:s}).then((function(e){e.data.success?rt(e.data.gameDetail):alert("\uac8c\uc784 \uc815\ubcf4\ub97c \ub85c\ub529\ud558\ub294\ub370 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4.")}))}),[P,s]),Object(n.useEffect)((function(){ct.character&&ot(c.a.createElement("div",{className:"scenemake__toggleBar"},c.a.createElement("div",{ref:He},c.a.createElement(Ve,{gameDetail:ct,setMakeModalState:M,setCharacterList:Z,setName:de})),c.a.createElement("div",{ref:Ge,style:{display:"none"}},c.a.createElement(Xe,{gameDetail:ct,setBackgroundImg:ae,setMakeModalState:M})),c.a.createElement("div",{ref:qe,style:{display:"none"}},c.a.createElement(Je,{gameDetail:ct,bgm_audio:Ct,setBgmFile:be,setMakeModalState:M})),c.a.createElement("div",{ref:We,style:{display:"none"}},c.a.createElement($e,{gameDetail:ct,sound_audio:Lt,setSoundFile:ye,setMakeModalState:M}))))}),[ct,J,P]),Object(n.useEffect)((function(){window.addEventListener("resize",(function(){O(window.innerWidth),S(window.innerHeight)})),C(.5625*_>N?{width:"".concat(.8*N/.5625,"px"),height:"".concat(.8*N,"px"),minWidth:"".concat(300/.5625,"px"),minHeight:"".concat(300,"px")}:{width:"".concat(.8*_,"px"),height:"".concat(.8*_*.5625,"px"),minWidth:"".concat(300,"px"),minHeight:"".concat(168.75,"px")})}),[window.innerWidth,window.innerHeight]);return c.a.createElement("div",{className:"scene__container"},c.a.createElement("div",null,c.a.createElement("div",{className:"backgroundImg_container",id:"backgroundImg_container",style:I},c.a.createElement("img",{className:"backgroundImg",src:"".concat(te),alt:"img"}),c.a.createElement(Ot,{GameCharacterList:ct.character,CharacterList:J,setCharacterList:Z,onRemove_character:function(e){Z((function(t){return[].concat(Object(ne.a)(t.slice(0,e)),Object(ne.a)(t.slice(e+1,4)))}))}}),Q&&c.a.createElement("div",{className:"sceneMake__text_container"},c.a.createElement("input",{onChange:function(e){de(e.currentTarget.value)},value:me,className:"sceneMake__name_block"}),c.a.createElement("hr",{className:"sceneMake__text_line"}),c.a.createElement("textarea",{onChange:function(e){se(e.currentTarget.value)},value:le,className:"sceneMake__text_block",ref:function(e){return e&&e.focus()}})))),c.a.createElement(kt,{setName:de,setCharacterList:Z,CharacterList:J,GameCharacterList:ct.character}),c.a.createElement(St,{CutList:Fe,CutNumber:we,displayCut:Ze,setCutNumber:Ie,Hover:Be,setHover:Te,EmptyCutList:Ue,saveCut:Ke}),c.a.createElement("div",{className:"sceneMake__sound_container"},ge.name?c.a.createElement("div",{className:"scene__SoundBox_container",onClick:function(){Ct.paused?Ct.play():Ct.pause(),z((function(e){return e+1}))}},ge.name&&Ct.paused&&c.a.createElement(xt.a,{style:{fontSize:"20px"}}),ge.name&&!Ct.paused&&c.a.createElement(wt.a,{style:{fontSize:"20px"}}),ge.name):c.a.createElement("div",null,c.a.createElement(It.a,{style:{fontSize:"20px"}}),"BGM"),he.name?c.a.createElement("div",{className:"scene__SoundBox_container",onClick:function(){Lt.paused?Lt.play():Lt.pause(),z((function(e){return e+1}))}},ge.name&&Lt.paused&&c.a.createElement(xt.a,{style:{fontSize:"20px"}}),ge.name&&!Lt.paused&&c.a.createElement(wt.a,{style:{fontSize:"20px"}}),he.name):c.a.createElement("div",null,c.a.createElement(It.a,{style:{fontSize:"20px"}}),"Sound")),c.a.createElement("div",{className:"sceneMake__btn_container"},c.a.createElement(G.a,{type:"primary",style:{fontSize:"15px"},onClick:function(){o.a.delete("/api/scene",{data:{gameId:s,sceneId:m,isFirst:je,userId:f.userData._id}}).then((function(t){t.data.success&&(console.log(je),0==je?(At.emit("empty_num_increase",{scene_id:t.data.prevSceneId,user_id:f.userData._id}),e.history.push("/game/".concat(s))):e.history.push("/"))}))}},"\uc791\uc131 \ucde8\uc18c"),c.a.createElement(G.a,{type:"primary",style:{fontSize:"15px"},onClick:function(e){tt(e,1)}},"\uc784\uc2dc\uc800\uc7a5"),c.a.createElement(G.a,{type:"primary",style:{fontSize:"15px"},onClick:function(){Fe.length-1<=we?h.a.info("\ub9c8\uc9c0\ub9c9 \ucef7 \uc785\ub2c8\ub2e4."):(h.a.success("".concat(we+1,"\ubc88\uc9f8 \ucef7\uc774 \uc0ad\uc81c\ub418\uc5c8\uc2b5\ub2c8\ub2e4.")),Re((function(e){return[].concat(Object(ne.a)(e.slice(0,we)),Object(ne.a)(e.slice(we+1,31)))})),Ae((function(e){return[0].concat(Object(ne.a)(e))})),Ze(we+1))}},"\ucef7 \uc0ad\uc81c"),we<29&&c.a.createElement(G.a,{type:"primary",style:{fontSize:"15px"},onClick:et},"\ub2e4\uc74c \ucef7"),je?c.a.createElement(G.a,{type:"primary",style:{fontSize:"15px"},onClick:function(){q(!0)}},"\uc5c5\ub85c\ub4dc"):c.a.createElement(G.a,{type:"primary",style:{fontSize:"15px"},onClick:tt},"\uc5c5\ub85c\ub4dc"),c.a.createElement(vt,{gameId:s,visible:H,setUploadModalState:q,onSubmit_saveScene:tt})),c.a.createElement("div",{className:"scenemake__sideBar_container"},0!==st&&st,c.a.createElement("div",{className:"scenemake__toggleButton_container"},c.a.createElement("div",{className:"scenemake__btn_sidebar",onClick:function(){"none"===He.current.style.display?Qe(He):Ye()}},"char"),c.a.createElement("div",{className:"scenemake__btn_sidebar",onClick:function(){"none"===Ge.current.style.display?Qe(Ge):Ye()}},"back"),c.a.createElement("div",{className:"scenemake__btn_sidebar",onClick:function(){Y(!Q)}},"script"),c.a.createElement("div",{className:"scenemake__btn_sidebar",onClick:function(){"none"===qe.current.style.display?Qe(qe):Ye()}},"bgm"),c.a.createElement("div",{className:"scenemake__btn_sidebar",onClick:function(){"none"===We.current.style.display?Qe(We):Ye()}},"sound"))),0!==D&&c.a.createElement(pt,{gameId:s,visible:Boolean(D),setTag:M,tag:D,setReload:z}))},Tt=a(1106);Tt.a.SubMenu,Tt.a.ItemGroup;var Dt=Object(i.h)((function(e){var t=Object(d.c)((function(e){return e.user})),a=function(){var t=Object(v.a)(b.a.mark((function t(){var a,n,c;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,o.a.get("/api/game/uploadgameframe");case 2:if((a=t.sent).data.success){t.next=6;break}return alert("game Frame\uc81c\uc791 \uc2e4\ud328"),t.abrupt("return");case 6:return n={gameId:a.data.game._id,prevSceneId:null,sceneDepth:0,isFirst:1,title:""},t.next=9,o.a.post("/api/scene/create",n);case 9:if((c=t.sent).data.success){t.next=13;break}return alert("scene Frame\uc81c\uc791 \uc2e4\ud328"),t.abrupt("return");case 13:h.a.success("\uccab Scene\uc744 \uc0dd\uc131\ud574\uc8fc\uc138\uc694. \uc624\ub978\ucabd\uc758 \ubc84\ud2bc\uc744 \ud65c\uc6a9\ud574 \uc774\ubbf8\uc9c0\ub4e4\uc744 \ucd94\uac00\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4."),setTimeout((function(){e.history.replace({pathname:"/scene/make",state:{gameId:a.data.game._id,sceneId:c.data.sceneId}})}),1e3);case 15:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return t.userData&&!t.userData.isAuth?c.a.createElement(Tt.a,{mode:e.mode},c.a.createElement(Tt.a.Item,{key:"mail"},c.a.createElement("a",{href:"/login"},"Signin")),c.a.createElement(Tt.a.Item,{key:"app"},c.a.createElement("a",{href:"/register"},"Signup"))):c.a.createElement(Tt.a,{mode:e.mode},c.a.createElement(Tt.a.Item,{key:"upload"},c.a.createElement("a",{onClick:a},"Game Upload")),c.a.createElement(Tt.a.Item,{key:"profile"},c.a.createElement("a",{href:"/profile"},"Profile")),c.a.createElement(Tt.a.Item,{key:"logout"},c.a.createElement("a",{onClick:function(){o.a.get("".concat("/api/users","/logout")).then((function(t){200===t.status?e.history.push("/login"):alert("Log Out Failed")}))}},"Logout")))})),Mt=a(1109);a(1051);var Ft=function(){var e=Object(n.useState)(!1),t=Object(E.a)(e,2),a=t[0],r=t[1],l={};return l=Object(d.c)((function(e){return e.controlpage.navbarOn}))?{position:"fixed",zIndex:5,width:"100%"}:{position:"fixed",zIndex:5,width:"100%",opacity:0,animation:"0.8s ease-out 0s 1 hide"},c.a.createElement("nav",{className:"menu",style:l},c.a.createElement("div",{className:"menu__logo"},c.a.createElement("a",{href:"/"},"REGANOP")),c.a.createElement("div",{className:"menu__container"},c.a.createElement("div",{className:"menu_rigth"},c.a.createElement(Dt,{mode:"horizontal"})),c.a.createElement(G.a,{className:"menu__mobile-button",type:"primary",onClick:function(){r(!0)}},c.a.createElement(A.a,{type:"align-right"})),c.a.createElement(Mt.a,{title:"REGANOP",placement:"right",className:"menu_drawer",closable:!1,onClose:function(){r(!1)},visible:a},c.a.createElement(Dt,{mode:"inline"}))))};a(1052);var Rt=function(){return c.a.createElement("div",{className:"footer_container"},c.a.createElement("p",null,"Mutsad \ud654\uc774\ud305 ",c.a.createElement(A.a,{type:"smile"})))},Pt=a(532),zt=a.n(Pt),Ut=(a(1086),a(219)),At=zt()(Ut.SOCKET,{transports:["websocket"]});window.onpopstate=function(){window.location.reload()};var Ht=function(){return c.a.createElement(n.Suspense,{fallback:c.a.createElement("div",null,"Loading...")},c.a.createElement(Ft,null),c.a.createElement("div",{className:"app"},c.a.createElement(i.c,null,c.a.createElement(i.a,{exact:!0,path:"/",component:p(x,null)}),c.a.createElement(i.a,{exact:!0,path:"/login",component:p(W,!1)}),c.a.createElement(i.a,{exact:!0,path:"/register",component:p(Y,!1)}),c.a.createElement(i.a,{exact:!0,path:"/profile",component:p(V,!0)}),c.a.createElement(i.a,{exact:!0,path:"/game/upload",component:p(te,!0)}),c.a.createElement(i.a,{path:"/game/:gameId",component:p(F,null)}),c.a.createElement(i.a,{path:"/gameplay",component:f(p(qe,null))}),c.a.createElement(i.a,{exact:!0,path:"/scene/make",component:f(p(Bt,!0))}))),c.a.createElement(Rt,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var Gt=a(136),qt={navbarOn:!0},Wt={loadingType:0,isPause:!1},Xt={description:"",image:"",image_array:[],name:"",_id:"",index:-1},Qt={index:-1},Yt={movingTarget:-1},Vt=Object(Gt.c)({user:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"register_user":return Object(ae.a)({},e,{register:t.payload});case"login_user":return Object(ae.a)({},e,{loginSucces:t.payload});case"auth_user":return Object(ae.a)({},e,{userData:t.payload});case"logout_user":return Object(ae.a)({},e);default:return e}},controlpage:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:qt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"navbar_control":return Object(ae.a)({},e,{navbarOn:t.payload});default:return e}},gameplay:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Wt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"gameLoading_gamePlay":return Object(ae.a)({},e,{loadingType:t.payload});case"pause_gamePlay":return Object(ae.a)({},e,{isPause:t.payload});default:return e}},sync:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"load_empty_num":return Object(ae.a)({},e,{emptyNum:t.payload});case"SAVE_PREV_SCENE":return Object(ae.a)({},e,{prevSceneId:t.payload});default:return e}},character:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{characterSelected:Xt},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"select_character":return Object(ae.a)({},e,{characterSelected:t.payload});case"detach_character":return Object(ae.a)({},e,{characterSelected:Xt});default:return e}},characterDisplayed:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{characterDisplayed:Qt},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"select_displayed":return Object(ae.a)({},e,{characterDisplayed:t.payload});default:return e}},movingTarget:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Yt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"select_movingtarget":case"detach_movingtarget":return Object(ae.a)({},e,{movingTarget:t.payload});default:return e}}}),Kt=a(533),Jt=a.n(Kt),Zt=a(534),$t=Object(Gt.a)(Jt.a,Zt.a)(Gt.d);l.a.render(c.a.createElement(d.a,{store:$t(Vt,window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__())},c.a.createElement(B.a,null,c.a.createElement(Ht,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},181:function(e,t,a){},219:function(e,t,a){e.exports=a(834)},496:function(e,t,a){},539:function(e,t,a){e.exports=a(1090)},768:function(e,t,a){},791:function(e,t,a){},831:function(e,t,a){},832:function(e,t,a){},833:function(e,t,a){},834:function(e,t){e.exports={STORAGE:"https://neverending.s3.ap-northeast-2.amazonaws.com/original",SERVER:"http://15.164.48.192:80",CLIENT:"https://13.209.68.246:80",SOCKET:"https://www.woosup.shop"}}},[[539,1,2]]]);
//# sourceMappingURL=main.8cf01008.chunk.js.map